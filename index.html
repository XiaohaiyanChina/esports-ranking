<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDTV CSGO排行榜</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <!-- Supabase客户端库 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary-color: #2ecc71;
            --primary-dark: #27ae60;
            --primary-light: #48c774;
            --secondary-color: #3498db;
            --dark-color: #2c3e50;
            --darker-color: #1a252f;
            --light-color: #ecf0f1;
            --gray-color: #7f8c8d;
            --light-gray: #bdc3c7;
            --white-color: #ffffff;
            --danger-color: #e74c3c;
            --danger-dark: #c0392b;
            --warning-color: #f39c12;
            --warning-dark: #e67e22;
            --info-color: #3498db;
            --success-color: #2ecc71;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-heavy: 0 8px 24px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --border-radius: 8px;
            --border-radius-sm: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* 导航栏 */
        .navbar {
            background-color: var(--darker-color);
            color: var(--white-color);
            padding: 0 20px;
            box-shadow: var(--shadow-heavy);
            position: sticky;
            top: 0;
            z-index: 1000;
            height: 70px;
            display: flex;
            align-items: center;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            text-decoration: none;
            transition: var(--transition);
        }

        .logo:hover {
            transform: translateY(-2px);
        }

        .logo i {
            margin-right: 12px;
            font-size: 2rem;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 5px;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            color: var(--white-color);
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 30px;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background-color: var(--primary-color);
            color: var(--white-color);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        }

        .admin-badge {
            background-color: var(--warning-color);
            color: var(--darker-color);
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            letter-spacing: 0.5px;
            margin-left: 6px;
        }

        /* 主内容区 */
        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }

        /* 页面标题 */
        .page-title {
            margin-bottom: 30px;
            color: var(--dark-color);
            padding-bottom: 15px;
            border-bottom: 3px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .page-title h2 {
            font-size: 2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .page-title h2 i {
            color: var(--primary-color);
        }

        .page-subtitle {
            color: var(--gray-color);
            font-size: 1rem;
            font-weight: 500;
        }

        /* 标签导航 */
        .tab-nav {
            display: flex;
            background-color: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 25px;
        }

        .tab-link {
            padding: 15px 30px;
            cursor: pointer;
            background: none;
            border: none;
            font-weight: 600;
            color: var(--gray-color);
            transition: var(--transition);
            flex: 1;
            text-align: center;
            position: relative;
        }

        .tab-link:hover {
            color: var(--primary-color);
            background-color: rgba(46, 204, 113, 0.05);
        }

        .tab-link.active {
            color: var(--primary-color);
            background-color: rgba(46, 204, 113, 0.1);
        }

        .tab-link.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary-color);
        }

        /* 卡片样式 */
        .card {
            background-color: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 25px;
            transition: var(--transition);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .card:hover {
            box-shadow: var(--shadow-heavy);
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-color);
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* 按钮样式 */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
            letter-spacing: 0.3px;
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: var(--white-color);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            box-shadow: 0 6px 15px rgba(46, 204, 113, 0.3);
        }

        .btn-secondary {
            background-color: var(--light-color);
            color: var(--dark-color);
        }

        .btn-secondary:hover {
            background-color: #d5dbdb;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), var(--danger-dark));
            color: var(--white-color);
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #ff6b6b, var(--danger-color));
            box-shadow: 0 6px 15px rgba(231, 76, 60, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #27ae60);
            color: var(--white-color);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), var(--warning-dark));
            color: var(--white-color);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        /* 表格样式 */
        .table-responsive {
            overflow-x: auto;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            background-color: var(--white-color);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .data-table th {
            background: linear-gradient(to right, var(--primary-color), var(--primary-dark));
            color: var(--white-color);
            font-weight: 600;
            text-align: left;
            padding: 18px 20px;
            font-size: 0.95rem;
            letter-spacing: 0.5px;
        }

        .data-table th:first-child {
            border-top-left-radius: var(--border-radius);
        }

        .data-table th:last-child {
            border-top-right-radius: var(--border-radius);
        }

        .data-table td {
            padding: 16px 20px;
            border-bottom: 1px solid var(--light-color);
            vertical-align: middle;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background-color: rgba(46, 204, 113, 0.05);
        }

        .data-table .highlight {
            background-color: rgba(46, 204, 113, 0.1);
        }

        /* 图片样式 */
        .team-logo-small {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-right: 12px;
            object-fit: cover;
            border: 2px solid var(--light-color);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .player-img-small {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            margin-right: 12px;
            object-fit: cover;
            border: 2px solid var(--light-color);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: var(--transition);
        }

        .player-img-small:hover {
            transform: scale(1.05);
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        }

        .team-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-right: 25px;
            object-fit: cover;
            border: 4px solid var(--white-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .player-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--white-color);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            cursor: pointer;
        }

        .player-avatar:hover {
            transform: scale(1.1);
            border-color: var(--primary-color);
            box-shadow: 0 6px 15px rgba(46, 204, 113, 0.3);
        }

        /* 评分徽章 */
        .rating-badge {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            display: inline-block;
            box-shadow: 0 3px 8px rgba(46, 204, 113, 0.2);
        }

        .rank-badge {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.85rem;
            display: inline-block;
        }

        /* 雷达图容器 */
        .radar-container {
            width: 350px;
            height: 350px;
            margin: 20px auto;
            position: relative;
        }

        /* 数据统计项 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-item {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            transition: var(--transition);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .stat-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray-color);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* 隐藏页面 */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 赛事卡片 */
        .match-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-left: 5px solid var(--primary-color);
            margin-bottom: 15px;
            border-radius: var(--border-radius);
            background-color: var(--white-color);
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .match-card:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-heavy);
            border-left-color: var(--primary-dark);
        }

        .match-date {
            color: var(--gray-color);
            font-size: 0.9rem;
            font-weight: 500;
            background-color: rgba(127, 140, 141, 0.1);
            padding: 5px 12px;
            border-radius: 20px;
        }

        .match-teams {
            display: flex;
            align-items: center;
            flex-grow: 1;
            justify-content: center;
            gap: 30px;
        }

        .match-team {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .match-team-name {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--dark-color);
        }

        .match-score {
            font-weight: 800;
            margin: 0 20px;
            font-size: 1.5rem;
            color: var(--dark-color);
            min-width: 80px;
            text-align: center;
        }

        .match-tournament {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.1rem;
            background-color: rgba(46, 204, 113, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
        }

        /* 战队卡片 */
        .team-card {
            display: flex;
            padding: 25px;
            align-items: center;
            border-left: 5px solid;
            margin-bottom: 20px;
            border-radius: var(--border-radius);
            background-color: var(--white-color);
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .team-card:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-heavy);
        }

        .team-rank {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--light-gray);
            margin-right: 25px;
            min-width: 60px;
            text-align: center;
        }

        .team-info {
            flex-grow: 1;
        }

        .team-name {
            font-size: 1.6rem;
            font-weight: 800;
            margin-bottom: 8px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .team-details {
            color: var(--gray-color);
            font-size: 0.95rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .team-players {
            display: flex;
            margin-top: 15px;
            gap: 8px;
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.95rem;
        }

        .form-control {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid var(--light-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: #f8f9fa;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            background-color: var(--white-color);
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2);
        }

        .form-row {
            display: flex;
            gap: 25px;
            margin-bottom: 20px;
        }

        .form-col {
            flex: 1;
        }

        /* 文件上传 */
        .file-upload {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 25px;
            background-color: #f8f9fa;
            border: 3px dashed #ddd;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            gap: 15px;
            flex-direction: column;
        }

        .file-upload-label:hover {
            border-color: var(--primary-color);
            background-color: rgba(46, 204, 113, 0.05);
        }

        .file-upload-label i {
            font-size: 2.5rem;
            color: var(--primary-color);
        }

        /* 管理员页面 */
        .admin-section {
            margin-bottom: 40px;
            padding: 30px;
            background-color: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .admin-section h3 {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--primary-color);
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.5rem;
        }

        /* 滑块样式 */
        .slider-group {
            margin-bottom: 20px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .slider-value {
            color: var(--primary-color);
            font-weight: 700;
            background-color: rgba(46, 204, 113, 0.1);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.9rem;
        }

        input[type="range"] {
            width: 100%;
            height: 10px;
            -webkit-appearance: none;
            background: linear-gradient(to right, #e0e0e0, var(--primary-color));
            border-radius: 5px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        /* 空状态 */
        .empty-state {
            text-align: center;
            padding: 60px 40px;
            color: var(--gray-color);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #ddd;
            opacity: 0.7;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--gray-color);
        }

        .empty-state p {
            font-size: 1rem;
            max-width: 500px;
            margin: 0 auto;
        }

        /* 加载器 */
        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(46, 204, 113, 0.2);
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 详细信息页面 */
        .detail-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-color);
        }

        .detail-info {
            flex-grow: 1;
        }

        .detail-title {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--dark-color);
            margin-bottom: 10px;
        }

        .detail-subtitle {
            color: var(--gray-color);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .detail-subtitle span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 战绩表格 */
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .stats-table th {
            background-color: var(--light-color);
            color: var(--dark-color);
            font-weight: 600;
            padding: 15px;
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
        }

        .stats-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid var(--light-color);
        }

        .stats-table tr:last-child td {
            border-bottom: none;
        }

        .stats-table tr:hover {
            background-color: rgba(46, 204, 113, 0.05);
        }

        /* 选手数据编辑表格 */
        .player-stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .player-stats-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            padding: 12px;
            text-align: center;
            font-size: 0.9rem;
        }

        .player-stats-table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid var(--light-color);
        }

        .player-stats-table input {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }

        /* 赛事详情编辑表单 */
        .match-edit-form {
            display: none;
            padding: 25px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            margin-top: 20px;
            border: 1px solid #dee2e6;
        }

        .match-edit-form.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .stats-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--light-color);
        }

        .stats-section h4 {
            margin-bottom: 20px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* 密码验证模态框 */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-card {
            background-color: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-heavy);
            padding: 40px;
            width: 100%;
            max-width: 500px;
            animation: fadeIn 0.3s ease;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--light-color);
        }

        .auth-tab {
            padding: 15px 30px;
            cursor: pointer;
            background: none;
            border: none;
            font-weight: 600;
            color: var(--gray-color);
            transition: var(--transition);
            position: relative;
        }

        .auth-tab.active {
            color: var(--primary-color);
        }

        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary-color);
        }

        .auth-content {
            display: none;
        }

        .auth-content.active {
            display: block;
        }

        /* 批量删除按钮 */
        .batch-actions {
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .select-all-checkbox {
            margin-right: 10px;
        }

        /* 复选框样式 */
        .checkbox-cell {
            width: 50px;
            text-align: center;
        }

        /* 响应式设计 */
        @media (max-width: 1200px) {
            .container {
                padding: 0 15px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .radar-container {
                width: 300px;
                height: 300px;
            }
        }

        @media (max-width: 992px) {
            .nav-menu {
                position: fixed;
                top: 70px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 70px);
                background-color: var(--darker-color);
                flex-direction: column;
                align-items: center;
                padding: 40px 0;
                transition: var(--transition);
                z-index: 999;
                overflow-y: auto;
            }
            
            .nav-menu.active {
                left: 0;
            }
            
            .nav-item {
                width: 100%;
                text-align: center;
            }
            
            .nav-link {
                justify-content: center;
                padding: 15px 20px;
                border-radius: 0;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .hamburger {
                display: block;
                cursor: pointer;
                width: 30px;
                height: 20px;
                position: relative;
            }
            
            .hamburger span {
                display: block;
                position: absolute;
                height: 3px;
                width: 100%;
                background: var(--white-color);
                border-radius: 3px;
                transition: var(--transition);
            }
            
            .hamburger span:nth-child(1) {
                top: 0;
            }
            
            .hamburger span:nth-child(2) {
                top: 8px;
            }
            
            .hamburger span:nth-child(3) {
                top: 16px;
            }
            
            .hamburger.active span:nth-child(1) {
                top: 8px;
                transform: rotate(45deg);
            }
            
            .hamburger.active span:nth-child(2) {
                opacity: 0;
            }
            
            .hamburger.active span:nth-child(3) {
                top: 8px;
                transform: rotate(-45deg);
            }
            
            .match-teams {
                flex-direction: column;
                gap: 15px;
            }
            
            .team-card {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .team-rank {
                margin-right: 0;
                margin-bottom: 10px;
            }
            
            .team-logo {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .team-players {
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .page-title {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .page-title h2 {
                font-size: 1.8rem;
            }
            
            .tab-nav {
                flex-direction: column;
            }
            
            .tab-link {
                padding: 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            .detail-header {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .radar-container {
                width: 280px;
                height: 280px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .player-stats-table {
                font-size: 0.85rem;
            }
            
            .player-stats-table input {
                width: 60px;
                padding: 6px;
            }
        }

        @media (max-width: 576px) {
            .navbar {
                padding: 0 15px;
            }
            
            .logo {
                font-size: 1.5rem;
            }
            
            .logo i {
                font-size: 1.8rem;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-control {
                padding: 12px 15px;
            }
            
            .admin-section {
                padding: 20px;
            }
            
            .player-stats-table {
                display: block;
                overflow-x: auto;
            }
        }

        /* 辅助类 */
        .text-primary {
            color: var(--primary-color);
        }

        .text-success {
            color: var(--success-color);
        }

        .text-danger {
            color: var(--danger-color);
        }

        .text-warning {
            color: var(--warning-color);
        }

        .text-muted {
            color: var(--gray-color);
        }

        .mt-1 { margin-top: 10px; }
        .mt-2 { margin-top: 20px; }
        .mt-3 { margin-top: 30px; }
        .mb-1 { margin-bottom: 10px; }
        .mb-2 { margin-bottom: 20px; }
        .mb-3 { margin-bottom: 30px; }
        .ml-1 { margin-left: 10px; }
        .ml-2 { margin-left: 20px; }
        .mr-1 { margin-right: 10px; }
        .mr-2 { margin-right: 20px; }

        .d-flex {
            display: flex;
        }

        .align-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-center {
            justify-content: center;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .w-100 {
            width: 100%;
        }
    </style>
</head>
<body>
    <!-- 密码验证模态框 -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-card">
            <div class="auth-tabs">
                <button class="auth-tab active" data-auth-tab="login">管理员登录</button>
                <button class="auth-tab" data-auth-tab="change-password">修改密码</button>
            </div>
            
            <div id="login-content" class="auth-content active">
                <h3 class="mb-3">管理员登录</h3>
                <div class="form-group">
                    <label class="form-label" for="admin-password-input">管理员密码</label>
                    <input type="password" id="admin-password-input" class="form-control" placeholder="请输入管理员密码">
                </div>
                <div class="form-group">
                    <button id="admin-login-btn" class="btn btn-primary w-100">
                        <i class="fas fa-sign-in-alt"></i> 登录
                    </button>
                </div>
            </div>
            
            <div id="change-password-content" class="auth-content">
                <h3 class="mb-3">修改密码</h3>
                <div class="form-group">
                    <label class="form-label" for="current-password">当前密码</label>
                    <input type="password" id="current-password" class="form-control" placeholder="请输入当前密码">
                </div>
                <div class="form-group">
                    <label class="form-label" for="security-code">安全码</label>
                    <input type="text" id="security-code" class="form-control" placeholder="请输入安全码">
                </div>
                <div class="form-group">
                    <label class="form-label" for="new-password">新密码</label>
                    <input type="password" id="new-password" class="form-control" placeholder="请输入新密码">
                </div>
                <div class="form-group">
                    <label class="form-label" for="confirm-new-password">确认新密码</label>
                    <input type="password" id="confirm-new-password" class="form-control" placeholder="请确认新密码">
                </div>
                <div class="form-group">
                    <button id="change-password-btn" class="btn btn-primary w-100">
                        <i class="fas fa-key"></i> 修改密码
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo" data-page="home">
                <i class="fas fa-trophy"></i>
                <span>LDTV CSGO</span>
            </a>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-page="home">
                        <i class="fas fa-calendar-alt"></i>
                        <span>赛事日程</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-page="teams">
                        <i class="fas fa-users"></i>
                        <span>战队排行</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-page="players">
                        <i class="fas fa-user"></i>
                        <span>选手排行</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-page="admin" id="admin-nav-link">
                        <i class="fas fa-cog"></i>
                        <span>管理员</span>
                        <span class="admin-badge">ADMIN</span>
                    </a>
                </li>
            </ul>
            
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- 主内容区 -->
    <div class="container">
        <!-- 首页：赛事页面 -->
        <div id="home-page" class="page active">
            <div class="page-title">
                <h2><i class="fas fa-calendar-alt"></i> 赛事日程与结果</h2>
                <div class="page-subtitle">查看今日赛程、往期赛果和未来赛事安排</div>
            </div>

            <div class="tab-nav">
                <button class="tab-link active" data-tab="today">
                    <i class="fas fa-calendar-day"></i> 今日赛程
                </button>
                <button class="tab-link" data-tab="past">
                    <i class="fas fa-history"></i> 往期赛果
                </button>
                <button class="tab-link" data-tab="upcoming">
                    <i class="fas fa-calendar-week"></i> 未来赛事
                </button>
            </div>

            <div id="today-matches" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-day text-primary"></i>
                            今日赛程
                        </div>
                        <div class="match-date">2023年12月4日</div>
                    </div>
                    
                    <div class="match-card" data-match-id="1">
                        <div class="match-tournament">Start ladder Budapest Major 2025</div>
                        <div class="match-teams">
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/2ecc71/FFFFFF?text=F" class="team-logo-small" alt="Falcons">
                                <span class="match-team-name">Falcons</span>
                            </div>
                            <div class="match-score">VS</div>
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/3498db/FFFFFF?text=BB" class="team-logo-small" alt="BB">
                                <span class="match-team-name">BB</span>
                            </div>
                        </div>
                        <div class="match-date">23:00</div>
                    </div>
                </div>
            </div>

            <div id="past-matches" class="tab-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-history text-primary"></i>
                            往期赛果
                        </div>
                    </div>
                    
                    <div class="match-card" data-match-id="2">
                        <div class="match-tournament">BLAST Rivals 2025 Season 2</div>
                        <div class="match-teams">
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/2ecc71/FFFFFF?text=F" class="team-logo-small" alt="Falcons">
                                <span class="match-team-name">Falcons</span>
                            </div>
                            <div class="match-score">1 : 3</div>
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/e74c3c/FFFFFF?text=FUR" class="team-logo-small" alt="FURIA">
                                <span class="match-team-name">FURIA</span>
                            </div>
                        </div>
                        <div class="match-date">2023-12-01</div>
                    </div>
                    
                    <div class="match-card" data-match-id="3">
                        <div class="match-tournament">BLAST Rivals 2025 Season 2</div>
                        <div class="match-teams">
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/2ecc71/FFFFFF?text=F" class="team-logo-small" alt="Falcons">
                                <span class="match-team-name">Falcons</span>
                            </div>
                            <div class="match-score">2 : 0</div>
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/f39c12/FFFFFF?text=VIT" class="team-logo-small" alt="Vitality">
                                <span class="match-team-name">Vitality</span>
                            </div>
                        </div>
                        <div class="match-date">2023-11-28</div>
                    </div>
                </div>
            </div>

            <div id="upcoming-matches" class="tab-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-week text-primary"></i>
                            未来赛事
                        </div>
                    </div>
                    
                    <div class="match-card" data-match-id="4">
                        <div class="match-tournament">IEM Katowice 2024</div>
                        <div class="match-teams">
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/2ecc71/FFFFFF?text=F" class="team-logo-small" alt="Falcons">
                                <span class="match-team-name">Falcons</span>
                            </div>
                            <div class="match-score">VS</div>
                            <div class="match-team">
                                <img src="https://via.placeholder.com/50/3498db/FFFFFF?text=NV" class="team-logo-small" alt="NaVi">
                                <span class="match-team-name">NaVi</span>
                            </div>
                        </div>
                        <div class="match-date">2024-02-10</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 赛事详情页面 -->
        <div id="match-detail-page" class="page">
            <div class="page-title">
                <h2 id="match-detail-title"></h2>
                <button class="btn btn-secondary" id="back-to-home">
                    <i class="fas fa-arrow-left"></i> 返回赛事列表
                </button>
            </div>
            
            <div class="card">
                <div id="match-detail-content">
                    <!-- 赛事详情内容将通过JS动态生成 -->
                </div>
            </div>
        </div>

        <!-- 战队页面 -->
        <div id="teams-page" class="page">
            <div class="page-title">
                <h2><i class="fas fa-users"></i> 战队排行榜</h2>
                <div class="page-subtitle">按战队积分进行排名</div>
            </div>

            <div id="teams-list">
                <!-- 战队列表将通过JS动态生成 -->
            </div>
        </div>

        <!-- 战队详情页面 -->
        <div id="team-detail-page" class="page">
            <div class="page-title">
                <h2 id="team-detail-title"></h2>
                <button class="btn btn-secondary" id="back-to-teams">
                    <i class="fas fa-arrow-left"></i> 返回战队列表
                </button>
            </div>
            
            <div class="card">
                <div id="team-detail-content">
                    <!-- 战队详情内容将通过JS动态生成 -->
                </div>
            </div>
        </div>

        <!-- 选手页面 -->
        <div id="players-page" class="page">
            <div class="page-title">
                <h2><i class="fas fa-user"></i> 选手排行榜</h2>
                <div class="page-subtitle">按Rating 3.0进行排名</div>
            </div>

            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th width="80">排名</th>
                            <th>选手</th>
                            <th width="200">战队</th>
                            <th width="120">Rating 3.0</th>
                            <th width="100">火力</th>
                            <th width="100">首杀</th>
                            <th width="100">补枪</th>
                            <th width="150">主要成就</th>
                            <th width="120">操作</th>
                        </tr>
                    </thead>
                    <tbody id="players-table">
                        <!-- 选手列表将通过JS动态生成 -->
                    </tbody>
                </table>
            </div>

            <div id="player-detail" style="display: none;">
                <div class="page-title">
                    <h2 id="player-detail-name"></h2>
                    <button class="btn btn-secondary" id="back-to-players">
                        <i class="fas fa-arrow-left"></i> 返回选手列表
                    </button>
                </div>

                <div class="card">
                    <div class="form-row">
                        <div class="form-col">
                            <div class="detail-header">
                                <img id="player-detail-img" src="https://via.placeholder.com/150" class="team-logo" style="width: 150px; height: 150px;">
                                <div class="detail-info">
                                    <h1 id="player-detail-name-full" class="detail-title"></h1>
                                    <div class="detail-subtitle">
                                        <span><i class="fas fa-users"></i> 战队: <span id="player-detail-team"></span></span>
                                        <span><i class="fas fa-birthday-cake"></i> 年龄: <span id="player-detail-age"></span></span>
                                        <span><i class="fas fa-flag"></i> 国籍: <span id="player-detail-country"></span></span>
                                    </div>
                                </div>
                            </div>

                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="player-rating">1.14</div>
                                    <div class="stat-label">Rating 3.0</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="player-firepower">91</div>
                                    <div class="stat-label">火力 (Firepower)</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="player-entrying">59</div>
                                    <div class="stat-label">首杀 (Entrying)</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="player-trading">68</div>
                                    <div class="stat-label">补枪 (Trading)</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="player-opening">82</div>
                                    <div class="stat-label">开局 (Opening)</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="player-clutching">41</div>
                                    <div class="stat-label">残局 (Clutching)</div>
                                </div>
                            </div>
                            
                            <div class="mt-4" id="player-achievements-section" style="display: none;">
                                <h3><i class="fas fa-trophy"></i> 选手成就</h3>
                                <div class="achievements-list mt-3" id="player-achievements-list">
                                    <!-- 选手成就将通过JS动态生成 -->
                                </div>
                            </div>
                        </div>

                        <div class="form-col">
                            <div class="radar-container">
                                <canvas id="player-radar"></canvas>
                            </div>
                            <div class="mt-3">
                                <h4><i class="fas fa-balance-scale"></i> 选手对比</h4>
                                <select id="compare-player-select" class="form-control mt-2">
                                    <option value="">选择对比选手</option>
                                </select>
                                <div class="radar-container mt-3" id="compare-radar-container" style="display: none;">
                                    <canvas id="compare-radar"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 管理员页面 -->
        <div id="admin-page" class="page">
            <div class="page-title">
                <h2><i class="fas fa-cog"></i> 管理员面板</h2>
                <div class="page-subtitle">管理战队、选手和赛事数据</div>
                <button id="admin-logout-btn" class="btn btn-warning">
                    <i class="fas fa-sign-out-alt"></i> 退出登录
                </button>
            </div>

            <div class="admin-section">
                <h3><i class="fas fa-users"></i> 战队管理</h3>
                <div class="batch-actions">
                    <input type="checkbox" id="select-all-teams" class="select-all-checkbox">
                    <label for="select-all-teams">全选</label>
                    <button class="btn btn-danger btn-sm" id="batch-delete-teams">
                        <i class="fas fa-trash"></i> 批量删除选中战队
                    </button>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <h4 class="mb-3">添加/编辑战队</h4>
                        <form id="team-form">
                            <input type="hidden" id="team-id">
                            <div class="form-group">
                                <label class="form-label" for="team-name">战队名称</label>
                                <input type="text" id="team-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="team-rank">世界排名</label>
                                <input type="number" id="team-rank" class="form-control" min="1" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="team-points">积分</label>
                                <input type="number" id="team-points" class="form-control" min="0" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="team-coach">教练</label>
                                <input type="text" id="team-coach" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="team-achievements">战队成就</label>
                                <textarea id="team-achievements" class="form-control" rows="3" placeholder="输入战队获得的成就，用逗号分隔"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="team-logo-upload">战队徽标</label>
                                <div class="file-upload">
                                    <label for="team-logo-upload" class="file-upload-label">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <span>点击上传战队徽标</span>
                                        <small class="text-muted">支持 JPG, PNG 格式，建议尺寸 200x200</small>
                                    </label>
                                    <input type="file" id="team-logo-upload" accept="image/*">
                                </div>
                                <div id="team-logo-preview" class="mt-2"></div>
                            </div>
                            <div class="form-group d-flex justify-between">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> 保存战队
                                </button>
                                <button type="button" class="btn btn-secondary" id="reset-team-form">
                                    <i class="fas fa-redo"></i> 重置表单
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="form-col">
                        <h4 class="mb-3">战队列表</h4>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th class="checkbox-cell">选择</th>
                                        <th>战队</th>
                                        <th width="100">排名</th>
                                        <th width="100">积分</th>
                                        <th width="120">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-teams-list">
                                    <!-- 战队列表将通过JS动态生成 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="admin-section">
                <h3><i class="fas fa-user"></i> 选手管理</h3>
                <div class="batch-actions">
                    <input type="checkbox" id="select-all-players" class="select-all-checkbox">
                    <label for="select-all-players">全选</label>
                    <button class="btn btn-danger btn-sm" id="batch-delete-players">
                        <i class="fas fa-trash"></i> 批量删除选中选手
                    </button>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <h4 class="mb-3">添加/编辑选手</h4>
                        <form id="player-form">
                            <input type="hidden" id="player-id">
                            <div class="form-group">
                                <label class="form-label" for="player-name">选手ID</label>
                                <input type="text" id="player-name" class="form-control" required placeholder="选手游戏ID">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="player-realname">真实姓名</label>
                                <input type="text" id="player-realname" class="form-control" placeholder="选手真实姓名">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="player-team">所属战队</label>
                                <select id="player-team" class="form-control" required>
                                    <option value="">选择战队</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="player-achievements">选手成就</label>
                                <textarea id="player-achievements" class="form-control" rows="3" placeholder="输入选手获得的成就，用逗号分隔"></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="player-age">年龄</label>
                                        <input type="number" id="player-age" class="form-control" min="15" max="50">
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="player-country">国籍</label>
                                        <input type="text" id="player-country" class="form-control" placeholder="如: 中国">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="player-rating-input">Rating 3.0</label>
                                <input type="number" id="player-rating-input" class="form-control" min="0" max="3" step="0.01" value="1.00">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="player-img-upload">选手照片</label>
                                <div class="file-upload">
                                    <label for="player-img-upload" class="file-upload-label">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <span>点击上传选手照片</span>
                                        <small class="text-muted">支持 JPG, PNG 格式，建议尺寸 200x200</small>
                                    </label>
                                    <input type="file" id="player-img-upload" accept="image/*">
                                </div>
                                <div id="player-img-preview" class="mt-2"></div>
                            </div>
                            <div class="form-group d-flex justify-between">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> 保存选手
                                </button>
                                <button type="button" class="btn btn-secondary" id="reset-player-form">
                                    <i class="fas fa-redo"></i> 重置表单
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="form-col">
                        <h4 class="mb-3">选手能力数据</h4>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>火力 (Firepower)</span>
                                        <span id="firepower-value" class="slider-value">91</span>
                                    </div>
                                    <input type="range" id="player-firepower-input" min="0" max="100" value="91">
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>首杀 (Entrying)</span>
                                        <span id="entrying-value" class="slider-value">59</span>
                                    </div>
                                    <input type="range" id="player-entrying-input" min="0" max="100" value="59">
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>补枪 (Trading)</span>
                                        <span id="trading-value" class="slider-value">68</span>
                                    </div>
                                    <input type="range" id="player-trading-input" min="0" max="100" value="68">
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>开局 (Opening)</span>
                                        <span id="opening-value" class="slider-value">82</span>
                                    </div>
                                    <input type="range" id="player-opening-input" min="0" max="100" value="82">
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>残局 (Clutching)</span>
                                        <span id="clutching-value" class="slider-value">41</span>
                                    </div>
                                    <input type="range" id="player-clutching-input" min="0" max="100" value="41">
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>道具 (Utility)</span>
                                        <span id="utility-value" class="slider-value">27</span>
                                    </div>
                                    <input type="range" id="player-utility-input" min="0" max="100" value="27">
                                </div>
                            </div>
                        </div>
                        
                        <h4 class="mb-3 mt-3">选手列表</h4>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th class="checkbox-cell">选择</th>
                                        <th>选手</th>
                                        <th width="150">战队</th>
                                        <th width="100">Rating</th>
                                        <th width="120">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-players-list">
                                    <!-- 选手列表将通过JS动态生成 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="admin-section">
                <h3><i class="fas fa-calendar-alt"></i> 赛事管理</h3>
                <div class="batch-actions">
                    <input type="checkbox" id="select-all-matches" class="select-all-checkbox">
                    <label for="select-all-matches">全选</label>
                    <button class="btn btn-danger btn-sm" id="batch-delete-matches">
                        <i class="fas fa-trash"></i> 批量删除选中赛事
                    </button>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <h4 class="mb-3">添加/编辑赛事</h4>
                        <form id="match-form">
                            <input type="hidden" id="match-id">
                            <div class="form-group">
                                <label class="form-label" for="match-tournament">赛事名称</label>
                                <input type="text" id="match-tournament" class="form-control" required>
                            </div>
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="match-team1">战队1</label>
                                        <select id="match-team1" class="form-control" required>
                                            <option value="">选择战队</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="match-team2">战队2</label>
                                        <select id="match-team2" class="form-control" required>
                                            <option value="">选择战队</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="match-score1">比分 (战队1)</label>
                                        <input type="number" id="match-score1" class="form-control" min="0" placeholder="留空为未开始">
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label class="form-label" for="match-score2">比分 (战队2)</label>
                                        <input type="number" id="match-score2" class="form-control" min="0" placeholder="留空为未开始">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="match-date">比赛日期</label>
                                <input type="date" id="match-date" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="match-time">比赛时间</label>
                                <input type="time" id="match-time" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="match-type">赛事类型</label>
                                <select id="match-type" class="form-control">
                                    <option value="today">今日赛程</option>
                                    <option value="past">往期赛果</option>
                                    <option value="upcoming">未来赛事</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-save"></i> 保存赛事
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="form-col">
                        <h4 class="mb-3">赛事列表</h4>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th class="checkbox-cell">选择</th>
                                        <th>赛事</th>
                                        <th width="200">战队</th>
                                        <th width="100">比分</th>
                                        <th width="120">日期</th>
                                        <th width="150">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-matches-list">
                                    <!-- 赛事列表将通过JS动态生成 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- 赛事详情编辑表单 -->
                <div class="match-edit-form" id="match-edit-form">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-edit text-primary"></i>
                            编辑赛事详情
                        </div>
                    </div>
                    
                    <form id="match-stats-form">
                        <input type="hidden" id="match-stats-id">
                        
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label class="form-label" for="edit-match-score1">战队1比分</label>
                                    <input type="number" id="edit-match-score1" class="form-control" min="0" required>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label class="form-label" for="edit-match-score2">战队2比分</label>
                                    <input type="number" id="edit-match-score2" class="form-control" min="0" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stats-section">
                            <h4><i class="fas fa-users"></i> 战队1选手数据</h4>
                            <div class="table-responsive">
                                <table class="player-stats-table">
                                    <thead>
                                        <tr>
                                            <th>选手</th>
                                            <th>击杀 (K)</th>
                                            <th>死亡 (D)</th>
                                            <th>关键击杀 (Swing)</th>
                                            <th>平均伤害 (ADR)</th>
                                            <th>KAST%</th>
                                            <th>Rating</th>
                                        </tr>
                                    </thead>
                                    <tbody id="team1-stats-body">
                                        <!-- 战队1选手数据将通过JS动态生成 -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="stats-section">
                            <h4><i class="fas fa-users"></i> 战队2选手数据</h4>
                            <div class="table-responsive">
                                <table class="player-stats-table">
                                    <thead>
                                        <tr>
                                            <th>选手</th>
                                            <th>击杀 (K)</th>
                                            <th>死亡 (D)</th>
                                            <th>关键击杀 (Swing)</th>
                                            <th>平均伤害 (ADR)</th>
                                            <th>KAST%</th>
                                            <th>Rating</th>
                                        </tr>
                                    </thead>
                                    <tbody id="team2-stats-body">
                                        <!-- 战队2选手数据将通过JS动态生成 -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="form-group d-flex justify-between mt-4">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> 保存赛事数据
                            </button>
                            <button type="button" class="btn btn-secondary" id="cancel-match-edit">
                                <i class="fas fa-times"></i> 取消
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // Supabase 配置 (注释状态，需要时启用)
        // ============================================
        /*
        // 初始化 Supabase 客户端
        const SUPABASE_URL = 'https://your-project.supabase.co';
        const SUPABASE_ANON_KEY = 'your-anon-key';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // 使用 Supabase 的数据操作函数示例
        async function loadDataFromSupabase() {
            try {
                // 从 Supabase 加载数据
                const { data: teams, error: teamsError } = await supabase
                    .from('teams')
                    .select('*')
                    .order('rank', { ascending: true });
                
                const { data: players, error: playersError } = await supabase
                    .from('players')
                    .select('*')
                    .order('rating', { ascending: false });
                
                const { data: matches, error: matchesError } = await supabase
                    .from('matches')
                    .select('*')
                    .order('date', { ascending: false });
                
                if (!teamsError && !playersError && !matchesError) {
                    appData.teams = teams;
                    appData.players = players;
                    appData.matches = matches;
                } else {
                    console.error('从 Supabase 加载数据失败:', teamsError, playersError, matchesError);
                    loadDefaultData();
                }
            } catch (error) {
                console.error('Supabase 连接错误:', error);
                loadDefaultData();
            }
        }
        
        async function saveDataToSupabase() {
            try {
                // 批量保存数据到 Supabase
                // 注意：这里需要根据实际表结构调整
                // 实际应用中可能需要更复杂的数据同步逻辑
                
                // 清空现有数据
                await supabase.from('teams').delete().neq('id', 0);
                await supabase.from('players').delete().neq('id', 0);
                await supabase.from('matches').delete().neq('id', 0);
                
                // 插入新数据
                await supabase.from('teams').insert(appData.teams);
                await supabase.from('players').insert(appData.players);
                await supabase.from('matches').insert(appData.matches);
                
                console.log('数据已保存到 Supabase');
            } catch (error) {
                console.error('保存到 Supabase 失败:', error);
            }
        }
        */

        // 全局数据存储
        const appData = {
            teams: [],
            players: [],
            matches: [],
            currentPlayerId: null,
            currentTeamId: null,
            currentMatchId: null,
            radarChart: null,
            compareRadarChart: null,
            adminAuthenticated: false // 管理员认证状态
        };

        // 默认数据
        const defaultData = {
            teams: [
                {
                    id: 1,
                    name: "Falcons",
                    rank: 2,
                    points: 950,
                    coach: "Danny 'zonic' Sørensen",
                    logo: "https://via.placeholder.com/200/2ecc71/FFFFFF?text=FAL",
                    achievements: ["BLAST Rivals 2025 Season 2 冠军", "IEM Chengdu 2025 亚军", "ESL Pro League S19 四强"],
                    players: [1, 2, 3, 4, 5]
                },
                {
                    id: 2,
                    name: "Vitality",
                    rank: 1,
                    points: 1050,
                    coach: "XTQZZZ",
                    logo: "https://via.placeholder.com/200/e74c3c/FFFFFF?text=VIT",
                    achievements: ["BLAST Paris Major 2023 冠军", "IEM Rio 2023 冠军", "ESL Pro League S18 冠军"],
                    players: [6, 7, 8, 9, 10]
                },
                {
                    id: 3,
                    name: "FaZe Clan",
                    rank: 3,
                    points: 900,
                    coach: "RobbaN",
                    logo: "https://via.placeholder.com/200/3498db/FFFFFF?text=FAZE",
                    achievements: ["PGL Major Antwerp 2022 冠军", "IEM Cologne 2022 冠军", "IEM Katowice 2022 冠军"],
                    players: [11, 12, 13, 14, 15]
                },
                {
                    id: 4,
                    name: "BB",
                    rank: 15,
                    points: 450,
                    coach: "Johnta",
                    logo: "https://via.placeholder.com/200/9b59b6/FFFFFF?text=BB",
                    achievements: ["CCT Online Finals #2 冠军"],
                    players: [16, 17, 18, 19, 20]
                },
                {
                    id: 5,
                    name: "FURIA",
                    rank: 12,
                    points: 520,
                    coach: "guerri",
                    logo: "https://via.placeholder.com/200/34495e/FFFFFF?text=FUR",
                    achievements: ["ESL Pro League S15 四强", "IEM Dallas 2022 亚军"],
                    players: [21, 22, 23, 24, 25]
                }
            ],
            players: [
                {
                    id: 1,
                    name: "kyousuke",
                    realName: "Maxim Lukin",
                    teamId: 1,
                    age: 17,
                    country: "俄罗斯",
                    rating: 1.14,
                    img: "https://via.placeholder.com/200/2ecc71/FFFFFF?text=K",
                    achievements: ["BLAST Rivals 2025 Season 2 MVP", "年度最佳新秀"],
                    stats: {
                        firepower: 91,
                        entrying: 59,
                        trading: 68,
                        opening: 82,
                        clutching: 41,
                        utility: 27
                    }
                },
                {
                    id: 2,
                    name: "Niko",
                    realName: "Nikola Kovač",
                    teamId: 1,
                    age: 26,
                    country: "波黑",
                    rating: 1.15,
                    img: "https://via.placeholder.com/200/2ecc71/FFFFFF?text=N",
                    achievements: ["2024年IEM科隆MVP", "年度TOP 5选手", "Major冠军"],
                    stats: {
                        firepower: 95,
                        entrying: 85,
                        trading: 75,
                        opening: 80,
                        clutching: 65,
                        utility: 45
                    }
                },
                {
                    id: 3,
                    name: "mONESY",
                    realName: "Ilya Osipov",
                    teamId: 1,
                    age: 18,
                    country: "俄罗斯",
                    rating: 1.20,
                    img: "https://via.placeholder.com/200/2ecc71/FFFFFF?text=M",
                    achievements: ["ESL Pro League Season 19 MVP"],
                    stats: {
                        firepower: 90,
                        entrying: 70,
                        trading: 80,
                        opening: 85,
                        clutching: 60,
                        utility: 40
                    }
                },
                {
                    id: 6,
                    name: "ZywOo",
                    realName: "Mathieu Herbaut",
                    teamId: 2,
                    age: 22,
                    country: "法国",
                    rating: 1.30,
                    img: "https://via.placeholder.com/200/e74c3c/FFFFFF?text=Z",
                    achievements: ["2023年HLTV年度最佳选手", "BLAST巴黎Major MVP", "IEM里约冠军"],
                    stats: {
                        firepower: 98,
                        entrying: 75,
                        trading: 85,
                        opening: 90,
                        clutching: 95,
                        utility: 60
                    }
                },
                {
                    id: 11,
                    name: "rain",
                    realName: "Håvard Nygaard",
                    teamId: 3,
                    age: 28,
                    country: "挪威",
                    rating: 1.08,
                    img: "https://via.placeholder.com/200/3498db/FFFFFF?text=R",
                    achievements: ["PGL安特卫普Major冠军", "IEM科隆2022冠军"],
                    stats: {
                        firepower: 88,
                        entrying: 80,
                        trading: 70,
                        opening: 75,
                        clutching: 50,
                        utility: 35
                    }
                }
            ],
            matches: [
                {
                    id: 1,
                    tournament: "Start ladder Budapest Major 2025",
                    team1Id: 1,
                    team2Id: 4,
                    score1: null,
                    score2: null,
                    date: "2023-12-04",
                    time: "23:00",
                    type: "today",
                    stats: {
                        team1: {
                            1: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            2: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            3: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 }
                        },
                        team2: {
                            16: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            17: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            18: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 }
                        }
                    }
                },
                {
                    id: 2,
                    tournament: "BLAST Rivals 2025 Season 2",
                    team1Id: 1,
                    team2Id: 5,
                    score1: 1,
                    score2: 3,
                    date: "2023-12-01",
                    time: "",
                    type: "past",
                    stats: {
                        team1: {
                            1: { kill: 18, death: 22, swing: 3, adr: 78.5, kast: 68, rating: 0.98 },
                            2: { kill: 24, death: 20, swing: 5, adr: 92.3, kast: 72, rating: 1.25 },
                            3: { kill: 20, death: 21, swing: 2, adr: 80.1, kast: 65, rating: 1.05 }
                        },
                        team2: {
                            21: { kill: 26, death: 19, swing: 6, adr: 105.2, kast: 78, rating: 1.45 },
                            22: { kill: 22, death: 21, swing: 4, adr: 88.7, kast: 70, rating: 1.18 },
                            23: { kill: 19, death: 20, swing: 3, adr: 76.4, kast: 67, rating: 1.02 }
                        }
                    }
                },
                {
                    id: 3,
                    tournament: "BLAST Rivals 2025 Season 2",
                    team1Id: 1,
                    team2Id: 2,
                    score1: 2,
                    score2: 0,
                    date: "2023-11-28",
                    time: "",
                    type: "past",
                    stats: {
                        team1: {
                            1: { kill: 25, death: 18, swing: 5, adr: 95.2, kast: 75, rating: 1.35 },
                            2: { kill: 22, death: 20, swing: 4, adr: 88.7, kast: 70, rating: 1.20 },
                            3: { kill: 20, death: 19, swing: 3, adr: 82.3, kast: 68, rating: 1.15 }
                        },
                        team2: {
                            6: { kill: 23, death: 21, swing: 6, adr: 98.5, kast: 72, rating: 1.28 },
                            7: { kill: 19, death: 22, swing: 3, adr: 75.4, kast: 65, rating: 0.95 },
                            8: { kill: 18, death: 23, swing: 2, adr: 70.8, kast: 62, rating: 0.88 }
                        }
                    }
                },
                {
                    id: 4,
                    tournament: "IEM Katowice 2024",
                    team1Id: 1,
                    team2Id: 3,
                    score1: null,
                    score2: null,
                    date: "2024-02-10",
                    time: "",
                    type: "upcoming",
                    stats: {
                        team1: {
                            1: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            2: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            3: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 }
                        },
                        team2: {
                            11: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            12: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 },
                            13: { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 }
                        }
                    }
                }
            ]
        };

        // 初始化数据
        function initData() {
            // 检查管理员密码设置
            if (!localStorage.getItem('adminPassword')) {
                localStorage.setItem('adminPassword', 'LD123455');
                localStorage.setItem('adminSecurityCode', '762ER29781CS');
            }
            
            // 检查管理员认证状态
            appData.adminAuthenticated = localStorage.getItem('adminAuthenticated') === 'true';
            
            const savedData = localStorage.getItem('ldtvCsgoData');
            if (savedData) {
                try {
                    const parsed = JSON.parse(savedData);
                    appData.teams = parsed.teams || defaultData.teams;
                    appData.players = parsed.players || defaultData.players;
                    appData.matches = parsed.matches || defaultData.matches;
                } catch (e) {
                    console.error('加载数据失败，使用默认数据:', e);
                    loadDefaultData();
                }
            } else {
                loadDefaultData();
            }
            
            // 确保数据完整性
            validateData();
            saveData();
        }

        function loadDefaultData() {
            appData.teams = JSON.parse(JSON.stringify(defaultData.teams));
            appData.players = JSON.parse(JSON.stringify(defaultData.players));
            appData.matches = JSON.parse(JSON.stringify(defaultData.matches));
        }

        // 验证数据完整性
        function validateData() {
            // 确保每个战队都有players数组
            appData.teams.forEach(team => {
                if (!team.players) team.players = [];
                if (!team.achievements) team.achievements = [];
            });
            
            // 确保每个选手都有stats对象和achievements数组
            appData.players.forEach(player => {
                if (!player.stats) {
                    player.stats = {
                        firepower: 50,
                        entrying: 50,
                        trading: 50,
                        opening: 50,
                        clutching: 50,
                        utility: 50
                    };
                }
                if (!player.achievements) player.achievements = [];
            });
            
            // 确保每场比赛都有stats对象
            appData.matches.forEach(match => {
                if (!match.stats) {
                    match.stats = {
                        team1: {},
                        team2: {}
                    };
                }
            });
        }

        // 保存数据
        function saveData() {
            localStorage.setItem('ldtvCsgoData', JSON.stringify(appData));
            
            // 如果启用了Supabase，也保存到云端
            /*
            if (typeof supabase !== 'undefined') {
                saveDataToSupabase();
            }
            */
        }

        // 工具函数
        function getTeamById(id) {
            return appData.teams.find(t => t.id === id);
        }

        function getPlayerById(id) {
            return appData.players.find(p => p.id === id);
        }

        function getMatchById(id) {
            return appData.matches.find(m => m.id === id);
        }

        function getTeamPlayers(teamId) {
            return appData.players.filter(p => p.teamId === teamId);
        }

        // 页面切换
        function switchPage(pageId, params = {}) {
            // 检查管理员页面访问权限
            if (pageId === 'admin' && !appData.adminAuthenticated) {
                showAuthModal();
                return;
            }
            
            // 隐藏所有页面
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });

            // 更新导航链接
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === pageId) {
                    link.classList.add('active');
                }
            });

            // 显示目标页面
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.classList.add('active');
                
                // 根据页面加载数据
                switch (pageId) {
                    case 'home':
                        loadMatches();
                        break;
                    case 'match-detail':
                        if (params.matchId) {
                            showMatchDetail(params.matchId);
                        }
                        break;
                    case 'teams':
                        loadTeams();
                        break;
                    case 'team-detail':
                        if (params.teamId) {
                            showTeamDetail(params.teamId);
                        }
                        break;
                    case 'players':
                        loadPlayers();
                        // 确保选手详情页隐藏
                        document.getElementById('player-detail').style.display = 'none';
                        document.getElementById('players-table').parentNode.parentNode.style.display = 'block';
                        break;
                    case 'admin':
                        if (appData.adminAuthenticated) {
                            loadAdminData();
                        }
                        break;
                }
            }
            
            // 关闭移动端菜单
            closeMobileMenu();
            
            // 滚动到顶部
            window.scrollTo(0, 0);
        }

        // 显示认证模态框
        function showAuthModal() {
            const modal = document.getElementById('auth-modal');
            modal.classList.add('active');
            
            // 切换到登录标签
            document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.auth-content').forEach(content => content.classList.remove('active'));
            document.querySelector('.auth-tab[data-auth-tab="login"]').classList.add('active');
            document.getElementById('login-content').classList.add('active');
            
            // 清空输入框
            document.getElementById('admin-password-input').value = '';
            document.getElementById('current-password').value = '';
            document.getElementById('security-code').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-new-password').value = '';
        }

        // 隐藏认证模态框
        function hideAuthModal() {
            document.getElementById('auth-modal').classList.remove('active');
        }

        // 管理员登录
        function adminLogin() {
            const password = document.getElementById('admin-password-input').value;
            const savedPassword = localStorage.getItem('adminPassword');
            
            if (password === savedPassword) {
                appData.adminAuthenticated = true;
                localStorage.setItem('adminAuthenticated', 'true');
                hideAuthModal();
                switchPage('admin');
            } else {
                alert('密码错误！');
            }
        }

        // 修改密码
        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const securityCode = document.getElementById('security-code').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-new-password').value;
            
            const savedPassword = localStorage.getItem('adminPassword');
            const savedSecurityCode = localStorage.getItem('adminSecurityCode');
            
            if (currentPassword !== savedPassword) {
                alert('当前密码错误！');
                return;
            }
            
            if (securityCode !== savedSecurityCode) {
                alert('安全码错误！');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('新密码与确认密码不一致！');
                return;
            }
            
            if (newPassword.length < 6) {
                alert('新密码长度不能少于6位！');
                return;
            }
            
            localStorage.setItem('adminPassword', newPassword);
            alert('密码修改成功！');
            
            // 清空表单
            document.getElementById('current-password').value = '';
            document.getElementById('security-code').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-new-password').value = '';
            
            // 切换到登录标签
            document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.auth-content').forEach(content => content.classList.remove('active'));
            document.querySelector('.auth-tab[data-auth-tab="login"]').classList.add('active');
            document.getElementById('login-content').classList.add('active');
        }

        // 管理员退出登录
        function adminLogout() {
            appData.adminAuthenticated = false;
            localStorage.setItem('adminAuthenticated', 'false');
            alert('已退出管理员登录');
            switchPage('home');
        }

        // 加载赛事数据
        function loadMatches() {
            const todayMatches = appData.matches.filter(m => m.type === 'today');
            const pastMatches = appData.matches.filter(m => m.type === 'past');
            const upcomingMatches = appData.matches.filter(m => m.type === 'upcoming');

            // 今日赛程
            const todayContainer = document.getElementById('today-matches');
            if (todayMatches.length > 0) {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-day text-primary"></i>
                            今日赛程
                        </div>
                        <div class="match-date">${new Date().toLocaleDateString('zh-CN')}</div>
                    </div>
                `;
                
                todayMatches.forEach(match => {
                    const matchElement = createMatchElement(match);
                    card.appendChild(matchElement);
                });
                
                todayContainer.innerHTML = '';
                todayContainer.appendChild(card);
            } else {
                todayContainer.innerHTML = `
                    <div class="card empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <h3>今日暂无赛事</h3>
                        <p>今天没有安排比赛，请查看未来赛事或往期赛果</p>
                    </div>
                `;
            }

            // 往期赛果
            const pastContainer = document.getElementById('past-matches');
            if (pastMatches.length > 0) {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-history text-primary"></i>
                            往期赛果
                        </div>
                    </div>
                `;
                
                pastMatches.forEach(match => {
                    const matchElement = createMatchElement(match);
                    card.appendChild(matchElement);
                });
                
                pastContainer.innerHTML = '';
                pastContainer.appendChild(card);
            } else {
                pastContainer.innerHTML = `
                    <div class="card empty-state">
                        <i class="fas fa-history"></i>
                        <h3>暂无往期赛事</h3>
                        <p>暂时没有往期赛事记录</p>
                    </div>
                `;
            }

            // 未来赛事
            const upcomingContainer = document.getElementById('upcoming-matches');
            if (upcomingMatches.length > 0) {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-week text-primary"></i>
                            未来赛事
                        </div>
                    </div>
                `;
                
                upcomingMatches.forEach(match => {
                    const matchElement = createMatchElement(match);
                    card.appendChild(matchElement);
                });
                
                upcomingContainer.innerHTML = '';
                upcomingContainer.appendChild(card);
            } else {
                upcomingContainer.innerHTML = `
                    <div class="card empty-state">
                        <i class="fas fa-calendar-plus"></i>
                        <h3>暂无未来赛事</h3>
                        <p>暂时没有未来的赛事安排</p>
                    </div>
                `;
            }
            
            // 添加赛事点击事件
            document.querySelectorAll('.match-card').forEach(card => {
                card.addEventListener('click', function() {
                    const matchId = parseInt(this.getAttribute('data-match-id'));
                    switchPage('match-detail', { matchId });
                });
            });
        }

        // 创建赛事元素
        function createMatchElement(match) {
            const team1 = getTeamById(match.team1Id);
            const team2 = getTeamById(match.team2Id);
            
            let scoreDisplay = 'VS';
            if (match.score1 !== null && match.score2 !== null) {
                scoreDisplay = `${match.score1} : ${match.score2}`;
            }
            
            const date = new Date(match.date);
            const formattedDate = date.toLocaleDateString('zh-CN');
            
            const div = document.createElement('div');
            div.className = 'match-card';
            div.setAttribute('data-match-id', match.id);
            
            div.innerHTML = `
                <div class="match-tournament">${match.tournament}</div>
                <div class="match-teams">
                    <div class="match-team">
                        <img src="${team1?.logo || 'https://via.placeholder.com/50'}" class="team-logo-small" alt="${team1?.name || '未知战队'}">
                        <span class="match-team-name">${team1?.name || '未知战队'}</span>
                    </div>
                    <div class="match-score">${scoreDisplay}</div>
                    <div class="match-team">
                        <img src="${team2?.logo || 'https://via.placeholder.com/50'}" class="team-logo-small" alt="${team2?.name || '未知战队'}">
                        <span class="match-team-name">${team2?.name || '未知战队'}</span>
                    </div>
                </div>
                <div class="match-date">${formattedDate}${match.time ? ' ' + match.time : ''}</div>
            `;
            
            return div;
        }

        // 显示赛事详情
        function showMatchDetail(matchId) {
            const match = getMatchById(matchId);
            if (!match) {
                alert('赛事不存在');
                switchPage('home');
                return;
            }
            
            const team1 = getTeamById(match.team1Id);
            const team2 = getTeamById(match.team2Id);
            const team1Players = getTeamPlayers(match.team1Id);
            const team2Players = getTeamPlayers(match.team2Id);
            
            // 设置标题
            document.getElementById('match-detail-title').textContent = match.tournament;
            
            // 构建详情内容
            let scoreDisplay = 'VS';
            if (match.score1 !== null && match.score2 !== null) {
                scoreDisplay = `${match.score1} : ${match.score2}`;
            }
            
            const date = new Date(match.date);
            const formattedDate = date.toLocaleDateString('zh-CN');
            
            let content = `
                <div class="detail-header">
                    <div class="detail-info">
                        <h1 class="detail-title">${match.tournament}</h1>
                        <div class="detail-subtitle">
                            <span><i class="fas fa-calendar"></i> ${formattedDate}</span>
                            <span><i class="fas fa-clock"></i> ${match.time || '时间待定'}</span>
                            <span><i class="fas fa-trophy"></i> ${match.type === 'today' ? '今日赛程' : match.type === 'past' ? '往期赛果' : '未来赛事'}</span>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mb-4">
                    <div class="d-flex justify-center align-center" style="gap: 50px;">
                        <div class="text-center">
                            <img src="${team1?.logo || 'https://via.placeholder.com/100'}" class="team-logo" style="width: 120px; height: 120px;">
                            <h3 class="mt-2">${team1?.name || '未知战队'}</h3>
                            <div class="rank-badge mt-1">世界排名 #${team1?.rank || 'N/A'}</div>
                        </div>
                        
                        <div class="match-score" style="font-size: 3rem; min-width: 150px;">${scoreDisplay}</div>
                        
                        <div class="text-center">
                            <img src="${team2?.logo || 'https://via.placeholder.com/100'}" class="team-logo" style="width: 120px; height: 120px;">
                            <h3 class="mt-2">${team2?.name || '未知战队'}</h3>
                            <div class="rank-badge mt-1">世界排名 #${team2?.rank || 'N/A'}</div>
                        </div>
                    </div>
                </div>
            `;
            
            // 如果有比分，显示战绩统计
            if (match.score1 !== null && match.score2 !== null) {
                content += `
                    <h3 class="mb-3"><i class="fas fa-chart-line"></i> 比赛数据统计</h3>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <h4 class="text-center mb-3">${team1?.name || '战队1'} 选手数据</h4>
                            <div class="table-responsive">
                                <table class="stats-table">
                                    <thead>
                                        <tr>
                                            <th>选手</th>
                                            <th>击杀 (K)</th>
                                            <th>死亡 (D)</th>
                                            <th>Swing</th>
                                            <th>ADR</th>
                                            <th>KAST%</th>
                                            <th>Rating</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                `;
                
                // 战队1选手数据
                team1Players.forEach(player => {
                    const stats = match.stats.team1[player.id] || { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 };
                    
                    content += `
                        <tr>
                            <td class="d-flex align-center">
                                <img src="${player.img}" class="player-img-small player-img-link" data-player-id="${player.id}" style="cursor: pointer;" title="点击查看选手详情">
                                <span>${player.name}</span>
                            </td>
                            <td>${stats.kill}</td>
                            <td>${stats.death}</td>
                            <td>${stats.swing}</td>
                            <td>${stats.adr.toFixed(1)}</td>
                            <td>${stats.kast}%</td>
                            <td><span class="rating-badge">${stats.rating.toFixed(2)}</span></td>
                        </tr>
                    `;
                });
                
                content += `
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="form-col">
                            <h4 class="text-center mb-3">${team2?.name || '战队2'} 选手数据</h4>
                            <div class="table-responsive">
                                <table class="stats-table">
                                    <thead>
                                        <tr>
                                            <th>选手</th>
                                            <th>击杀 (K)</th>
                                            <th>死亡 (D)</th>
                                            <th>Swing</th>
                                            <th>ADR</th>
                                            <th>KAST%</th>
                                            <th>Rating</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                `;
                
                // 战队2选手数据
                team2Players.forEach(player => {
                    const stats = match.stats.team2[player.id] || { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 };
                    
                    content += `
                        <tr>
                            <td class="d-flex align-center">
                                <img src="${player.img}" class="player-img-small player-img-link" data-player-id="${player.id}" style="cursor: pointer;" title="点击查看选手详情">
                                <span>${player.name}</span>
                            </td>
                            <td>${stats.kill}</td>
                            <td>${stats.death}</td>
                            <td>${stats.swing}</td>
                            <td>${stats.adr.toFixed(1)}</td>
                            <td>${stats.kast}%</td>
                            <td><span class="rating-badge">${stats.rating.toFixed(2)}</span></td>
                        </tr>
                    `;
                });
                
                content += `
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                content += `
                    <div class="empty-state">
                        <i class="fas fa-hourglass-half"></i>
                        <h3>比赛尚未开始</h3>
                        <p>比赛将在 ${formattedDate} ${match.time || ''} 开始，请届时关注</p>
                    </div>
                `;
            }
            
            document.getElementById('match-detail-content').innerHTML = content;
            
            // 添加选手头像点击事件 - 跳转到选手详情
            document.querySelectorAll('.player-img-link[data-player-id]').forEach(img => {
                img.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const playerId = parseInt(this.getAttribute('data-player-id'));
                    showPlayerDetailDirect(playerId);
                });
            });
        }

        // 直接显示选手详情（从任何页面）
        function showPlayerDetailDirect(playerId) {
            // 隐藏当前页面，显示选手页面
            switchPage('players');
            
            // 短暂延迟后显示选手详情
            setTimeout(() => {
                showPlayerDetail(playerId);
            }, 100);
        }

        // 加载战队数据
        function loadTeams() {
            const teamsList = document.getElementById('teams-list');
            teamsList.innerHTML = '';
            
            // 按积分排序
            const sortedTeams = [...appData.teams].sort((a, b) => b.points - a.points);
            
            if (sortedTeams.length === 0) {
                teamsList.innerHTML = `
                    <div class="card empty-state">
                        <i class="fas fa-users"></i>
                        <h3>暂无战队数据</h3>
                        <p>请在管理员页面添加战队</p>
                    </div>
                `;
                return;
            }
            
            sortedTeams.forEach((team, index) => {
                const teamPlayers = getTeamPlayers(team.id);
                const topPlayers = teamPlayers.slice(0, 5);
                
                // 根据排名设置边框颜色
                let borderColor = '#2ecc71'; // 默认绿色
                if (index === 0) borderColor = '#f39c12'; // 金色
                else if (index === 1) borderColor = '#95a5a6'; // 银色
                else if (index === 2) borderColor = '#cd7f32'; // 铜色
                
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                teamCard.style.borderLeftColor = borderColor;
                teamCard.setAttribute('data-team-id', team.id);
                
                teamCard.innerHTML = `
                    <div class="team-rank">#${index + 1}</div>
                    <img src="${team.logo}" class="team-logo" alt="${team.name}">
                    <div class="team-info">
                        <div class="team-name">
                            ${team.name}
                            <span class="rank-badge">世界排名 #${team.rank}</span>
                        </div>
                        <div class="team-details">
                            <span><i class="fas fa-trophy"></i> 积分: ${team.points}</span>
                            <span><i class="fas fa-user-tie"></i> 教练: ${team.coach || '未设置'}</span>
                            <span><i class="fas fa-users"></i> 队员: ${teamPlayers.length}人</span>
                        </div>
                        <div class="team-players">
                            ${topPlayers.map(player => `
                                <img src="${player.img}" class="player-avatar player-img-link" 
                                     title="${player.name} (Rating: ${player.rating.toFixed(2)})" 
                                     data-player-id="${player.id}">
                            `).join('')}
                            ${teamPlayers.length > 5 ? `<div class="player-avatar d-flex align-center justify-center" style="background-color: #f8f9fa; color: #7f8c8d; font-weight: 700;">+${teamPlayers.length - 5}</div>` : ''}
                        </div>
                    </div>
                    <div>
                        <button class="btn btn-primary view-team-btn" data-team-id="${team.id}">
                            <i class="fas fa-eye"></i> 查看详情
                        </button>
                    </div>
                `;
                
                teamsList.appendChild(teamCard);
            });
            
            // 添加战队点击事件
            document.querySelectorAll('.team-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // 如果不是点击按钮或选手头像，则进入战队详情
                    if (!e.target.closest('.view-team-btn') && !e.target.closest('.player-avatar')) {
                        const teamId = parseInt(this.getAttribute('data-team-id'));
                        switchPage('team-detail', { teamId });
                    }
                });
            });
            
            // 添加查看详情按钮事件
            document.querySelectorAll('.view-team-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const teamId = parseInt(this.getAttribute('data-team-id'));
                    switchPage('team-detail', { teamId });
                });
            });
            
            // 添加选手头像点击事件
            document.querySelectorAll('.player-avatar[data-player-id]').forEach(avatar => {
                avatar.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const playerId = parseInt(this.getAttribute('data-player-id'));
                    showPlayerDetailDirect(playerId);
                });
            });
        }

        // 显示战队详情
        function showTeamDetail(teamId) {
            const team = getTeamById(teamId);
            if (!team) {
                alert('战队不存在');
                switchPage('teams');
                return;
            }
            
            const teamPlayers = getTeamPlayers(teamId);
            const teamMatches = appData.matches.filter(m => m.team1Id === teamId || m.team2Id === teamId);
            
            // 设置标题
            document.getElementById('team-detail-title').textContent = team.name;
            
            // 构建详情内容
            let content = `
                <div class="detail-header">
                    <img src="${team.logo}" class="team-logo" style="width: 150px; height: 150px;">
                    <div class="detail-info">
                        <h1 class="detail-title">${team.name}</h1>
                        <div class="detail-subtitle">
                            <span><i class="fas fa-trophy"></i> 世界排名: #${team.rank}</span>
                            <span><i class="fas fa-star"></i> 积分: ${team.points}</span>
                            <span><i class="fas fa-user-tie"></i> 教练: ${team.coach || '未设置'}</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-row mt-4">
                    <div class="form-col">
                        <h3><i class="fas fa-users"></i> 战队成员 (${teamPlayers.length}人)</h3>
                        <div class="team-players mt-3" style="justify-content: flex-start; gap: 15px;">
                            ${teamPlayers.map(player => `
                                <div class="text-center player-img-link" style="cursor: pointer;" data-player-id="${player.id}">
                                    <img src="${player.img}" class="player-avatar">
                                    <div class="mt-2">
                                        <div style="font-weight: 700;">${player.name}</div>
                                        <div class="rating-badge mt-1">${player.rating.toFixed(2)}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="form-col">
                        <h3><i class="fas fa-trophy"></i> 战队成就</h3>
                        ${team.achievements && team.achievements.length > 0 ? `
                            <ul class="mt-3" style="padding-left: 20px;">
                                ${team.achievements.map(achievement => `
                                    <li class="mb-2" style="padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                                        <i class="fas fa-award text-warning mr-2"></i>${achievement}
                                    </li>
                                `).join('')}
                            </ul>
                        ` : `
                            <div class="empty-state mt-3" style="padding: 20px;">
                                <i class="fas fa-trophy"></i>
                                <p class="mt-2">暂无成就记录</p>
                            </div>
                        `}
                    </div>
                </div>
                
                <div class="mt-4">
                    <h3><i class="fas fa-history"></i> 近期赛事</h3>
            `;
            
            if (teamMatches.length > 0) {
                content += `
                    <div class="table-responsive mt-3">
                        <table class="stats-table">
                            <thead>
                                <tr>
                                    <th>赛事</th>
                                    <th>对手</th>
                                    <th>比分</th>
                                    <th>日期</th>
                                    <th>结果</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                teamMatches.slice(0, 10).forEach(match => {
                    const isTeam1 = match.team1Id === teamId;
                    const opponentId = isTeam1 ? match.team2Id : match.team1Id;
                    const opponent = getTeamById(opponentId);
                    const teamScore = isTeam1 ? match.score1 : match.score2;
                    const opponentScore = isTeam1 ? match.score2 : match.score1;
                    
                    let result = '未开始';
                    let resultClass = '';
                    
                    if (teamScore !== null && opponentScore !== null) {
                        if (teamScore > opponentScore) {
                            result = '胜利';
                            resultClass = 'text-success';
                        } else if (teamScore < opponentScore) {
                            result = '失败';
                            resultClass = 'text-danger';
                        } else {
                            result = '平局';
                            resultClass = 'text-warning';
                        }
                    }
                    
                    content += `
                        <tr>
                            <td>${match.tournament}</td>
                            <td>${opponent?.name || '未知战队'}</td>
                            <td>${teamScore !== null ? `${teamScore} : ${opponentScore}` : 'VS'}</td>
                            <td>${new Date(match.date).toLocaleDateString('zh-CN')}</td>
                            <td class="${resultClass}" style="font-weight: 700;">${result}</td>
                        </tr>
                    `;
                });
                
                content += `
                            </tbody>
                        </table>
                    </div>
                `;
            } else {
                content += `
                    <div class="empty-state mt-3" style="padding: 20px;">
                        <i class="fas fa-calendar-times"></i>
                        <p class="mt-2">暂无赛事记录</p>
                    </div>
                `;
            }
            
            content += `</div>`;
            
            document.getElementById('team-detail-content').innerHTML = content;
            
            // 添加选手点击事件
            document.querySelectorAll('.player-img-link[data-player-id]').forEach(element => {
                element.addEventListener('click', function() {
                    const playerId = parseInt(this.getAttribute('data-player-id'));
                    showPlayerDetailDirect(playerId);
                });
            });
        }

        // 加载选手数据
        function loadPlayers() {
            const playersTable = document.getElementById('players-table');
            playersTable.innerHTML = '';
            
            // 按Rating排序
            const sortedPlayers = [...appData.players].sort((a, b) => b.rating - a.rating);
            
            if (sortedPlayers.length === 0) {
                playersTable.innerHTML = `
                    <tr>
                        <td colspan="9" class="text-center" style="padding: 40px;">
                            <i class="fas fa-user-slash" style="font-size: 2rem; color: #ddd; margin-bottom: 10px;"></i>
                            <p style="color: #7f8c8d;">暂无选手数据</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            sortedPlayers.forEach((player, index) => {
                const team = getTeamById(player.teamId);
                const row = document.createElement('tr');
                
                // 高亮前三名
                if (index < 3) {
                    row.classList.add('highlight');
                }
                
                // 获取第一条成就
                const firstAchievement = player.achievements && player.achievements.length > 0 
                    ? player.achievements[0] 
                    : '';
                
                row.innerHTML = `
                    <td>
                        <div style="font-weight: 800; font-size: 1.2rem; color: ${index === 0 ? '#f39c12' : index === 1 ? '#95a5a6' : index === 2 ? '#cd7f32' : '#2c3e50'}">#${index + 1}</div>
                    </td>
                    <td>
                        <div class="d-flex align-center">
                            <img src="${player.img}" class="player-img-small player-img-link" alt="${player.name}" data-player-id="${player.id}" style="cursor: pointer;">
                            <div>
                                <div style="font-weight: 700; font-size: 1.1rem;">${player.name}</div>
                                <div style="font-size: 0.85rem; color: #7f8c8d;">${player.realName || ''}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        ${team ? `
                            <div class="d-flex align-center">
                                <img src="${team.logo}" class="team-logo-small">
                                <span>${team.name}</span>
                            </div>
                        ` : '<span style="color: #7f8c8d;">自由选手</span>'}
                    </td>
                    <td><span class="rating-badge">${player.rating.toFixed(2)}</span></td>
                    <td>${player.stats.firepower}</td>
                    <td>${player.stats.entrying}</td>
                    <td>${player.stats.trading}</td>
                    <td>${firstAchievement}</td>
                    <td>
                        <button class="btn btn-primary btn-sm view-player-btn" data-player-id="${player.id}">
                            <i class="fas fa-eye"></i> 查看
                        </button>
                    </td>
                `;
                
                playersTable.appendChild(row);
            });
            
            // 添加查看选手详情事件
            document.querySelectorAll('.view-player-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const playerId = parseInt(this.getAttribute('data-player-id'));
                    showPlayerDetail(playerId);
                });
            });
            
            // 添加选手头像点击事件
            document.querySelectorAll('.player-img-link[data-player-id]').forEach(img => {
                img.addEventListener('click', function() {
                    const playerId = parseInt(this.getAttribute('data-player-id'));
                    showPlayerDetail(playerId);
                });
            });
        }

        // 显示选手详情
        function showPlayerDetail(playerId) {
            const player = getPlayerById(playerId);
            if (!player) {
                alert('选手不存在');
                return;
            }
            
            const team = getTeamById(player.teamId);
            
            // 显示选手详情区域，隐藏列表
            document.getElementById('players-table').parentNode.parentNode.style.display = 'none';
            document.getElementById('player-detail').style.display = 'block';
            
            // 设置选手信息
            document.getElementById('player-detail-name').textContent = player.name;
            document.getElementById('player-detail-name-full').textContent = player.realName || player.name;
            document.getElementById('player-detail-team').textContent = team ? team.name : "自由选手";
            document.getElementById('player-detail-age').textContent = player.age || "未知";
            document.getElementById('player-detail-country').textContent = player.country || "未知";
            document.getElementById('player-detail-img').src = player.img;
            
            // 设置选手数据
            document.getElementById('player-rating').textContent = player.rating.toFixed(2);
            document.getElementById('player-firepower').textContent = player.stats.firepower;
            document.getElementById('player-entrying').textContent = player.stats.entrying;
            document.getElementById('player-trading').textContent = player.stats.trading;
            document.getElementById('player-opening').textContent = player.stats.opening;
            document.getElementById('player-clutching').textContent = player.stats.clutching;
            
            // 显示选手成就
            const achievementsSection = document.getElementById('player-achievements-section');
            const achievementsList = document.getElementById('player-achievements-list');
            
            if (player.achievements && player.achievements.length > 0) {
                achievementsSection.style.display = 'block';
                achievementsList.innerHTML = `
                    <ul style="padding-left: 20px;">
                        ${player.achievements.map(achievement => `
                            <li class="mb-2" style="padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                                <i class="fas fa-award text-warning mr-2"></i>${achievement}
                            </li>
                        `).join('')}
                    </ul>
                `;
            } else {
                achievementsSection.style.display = 'none';
            }
            
            // 更新雷达图
            updateRadarChart(player);
            
            // 更新对比选手选择
            updateCompareSelect(playerId);
            
            // 保存当前选手ID
            appData.currentPlayerId = playerId;
        }

        // 更新雷达图
        function updateRadarChart(player, comparePlayer = null) {
            const ctx = document.getElementById('player-radar').getContext('2d');
            
            // 销毁之前的图表
            if (appData.radarChart) {
                appData.radarChart.destroy();
            }
            
            const datasets = [
                {
                    label: player.name,
                    data: [
                        player.stats.firepower,
                        player.stats.entrying,
                        player.stats.trading,
                        player.stats.opening,
                        player.stats.clutching,
                        player.stats.utility || 0
                    ],
                    backgroundColor: 'rgba(46, 204, 113, 0.2)',
                    borderColor: 'rgba(46, 204, 113, 1)',
                    pointBackgroundColor: 'rgba(46, 204, 113, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(46, 204, 113, 1)',
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    borderWidth: 2
                }
            ];
            
            if (comparePlayer) {
                datasets.push({
                    label: comparePlayer.name,
                    data: [
                        comparePlayer.stats.firepower,
                        comparePlayer.stats.entrying,
                        comparePlayer.stats.trading,
                        comparePlayer.stats.opening,
                        comparePlayer.stats.clutching,
                        comparePlayer.stats.utility || 0
                    ],
                    backgroundColor: 'rgba(52, 152, 219, 0.2)',
                    borderColor: 'rgba(52, 152, 219, 1)',
                    pointBackgroundColor: 'rgba(52, 152, 219, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(52, 152, 219, 1)',
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    borderWidth: 2
                });
            }
            
            appData.radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['火力', '首杀', '补枪', '开局', '残局', '道具'],
                    datasets: datasets
                },
                options: {
                    scales: {
                        r: {
                            min: 0,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                backdropColor: 'transparent'
                            },
                            pointLabels: {
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#2c3e50'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            angleLines: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            titleFont: {
                                size: 14
                            },
                            bodyFont: {
                                size: 14
                            },
                            padding: 12,
                            backgroundColor: 'rgba(0, 0, 0, 0.7)'
                        }
                    },
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // 更新对比选手选择
        function updateCompareSelect(currentPlayerId) {
            const select = document.getElementById('compare-player-select');
            select.innerHTML = '<option value="">选择对比选手</option>';
            
            appData.players.forEach(player => {
                if (player.id !== currentPlayerId) {
                    const team = getTeamById(player.teamId);
                    const teamName = team ? team.name : "自由选手";
                    const option = document.createElement('option');
                    option.value = player.id;
                    option.textContent = `${player.name} (${teamName}) - Rating: ${player.rating.toFixed(2)}`;
                    select.appendChild(option);
                }
            });
            
            // 添加对比选择事件
            select.addEventListener('change', function() {
                const comparePlayerId = parseInt(this.value);
                const compareRadarContainer = document.getElementById('compare-radar-container');
                
                if (comparePlayerId) {
                    const currentPlayer = getPlayerById(appData.currentPlayerId);
                    const comparePlayer = getPlayerById(comparePlayerId);
                    
                    if (currentPlayer && comparePlayer) {
                        updateRadarChart(currentPlayer, comparePlayer);
                        compareRadarContainer.style.display = 'block';
                    }
                } else {
                    const currentPlayer = getPlayerById(appData.currentPlayerId);
                    if (currentPlayer) {
                        updateRadarChart(currentPlayer);
                        compareRadarContainer.style.display = 'none';
                    }
                }
            });
        }

        // 加载管理员数据
        function loadAdminData() {
            // 加载战队选择
            const teamSelects = [
                document.getElementById('player-team'),
                document.getElementById('match-team1'),
                document.getElementById('match-team2')
            ];
            
            teamSelects.forEach(select => {
                select.innerHTML = '<option value="">选择战队</option>';
                appData.teams.forEach(team => {
                    const option = document.createElement('option');
                    option.value = team.id;
                    option.textContent = `${team.name} (#${team.rank})`;
                    select.appendChild(option);
                });
            });
            
            // 加载战队列表
            loadAdminTeamsList();
            
            // 加载选手列表
            loadAdminPlayersList();
            
            // 加载赛事列表
            loadAdminMatchesList();
            
            // 初始化滑块值显示
            updateSliderValue('player-firepower-input', 'firepower-value');
            updateSliderValue('player-entrying-input', 'entrying-value');
            updateSliderValue('player-trading-input', 'trading-value');
            updateSliderValue('player-opening-input', 'opening-value');
            updateSliderValue('player-clutching-input', 'clutching-value');
            updateSliderValue('player-utility-input', 'utility-value');
            
            // 隐藏赛事详情编辑表单
            document.getElementById('match-edit-form').classList.remove('active');
            
            // 初始化全选复选框
            initBatchDeleteCheckboxes();
        }

        // 更新滑块值显示
        function updateSliderValue(sliderId, valueId) {
            const slider = document.getElementById(sliderId);
            const valueSpan = document.getElementById(valueId);
            
            if (slider && valueSpan) {
                valueSpan.textContent = slider.value;
                slider.addEventListener('input', function() {
                    valueSpan.textContent = this.value;
                });
            }
        }

        // 初始化批量删除复选框
        function initBatchDeleteCheckboxes() {
            // 战队全选
            const selectAllTeams = document.getElementById('select-all-teams');
            if (selectAllTeams) {
                selectAllTeams.addEventListener('change', function() {
                    const checkboxes = document.querySelectorAll('.team-checkbox');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                });
            }
            
            // 选手全选
            const selectAllPlayers = document.getElementById('select-all-players');
            if (selectAllPlayers) {
                selectAllPlayers.addEventListener('change', function() {
                    const checkboxes = document.querySelectorAll('.player-checkbox');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                });
            }
            
            // 赛事全选
            const selectAllMatches = document.getElementById('select-all-matches');
            if (selectAllMatches) {
                selectAllMatches.addEventListener('change', function() {
                    const checkboxes = document.querySelectorAll('.match-checkbox');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                });
            }
        }

        // 加载管理员战队列表
        function loadAdminTeamsList() {
            const list = document.getElementById('admin-teams-list');
            list.innerHTML = '';
            
            appData.teams.forEach(team => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="checkbox-cell">
                        <input type="checkbox" class="team-checkbox" data-team-id="${team.id}">
                    </td>
                    <td>
                        <div class="d-flex align-center">
                            <img src="${team.logo}" class="team-logo-small" alt="${team.name}">
                            <div>
                                <div style="font-weight: 700;">${team.name}</div>
                                <div style="font-size: 0.85rem; color: #7f8c8d;">教练: ${team.coach || '未设置'}</div>
                            </div>
                        </div>
                    </td>
                    <td>#${team.rank}</td>
                    <td>${team.points}</td>
                    <td>
                        <div class="d-flex" style="gap: 8px;">
                            <button class="btn btn-primary btn-sm edit-team-btn" data-team-id="${team.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger btn-sm delete-team-btn" data-team-id="${team.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                list.appendChild(row);
            });
            
            // 添加编辑战队事件
            document.querySelectorAll('.edit-team-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const teamId = parseInt(this.getAttribute('data-team-id'));
                    editTeam(teamId);
                });
            });
            
            // 添加删除战队事件
            document.querySelectorAll('.delete-team-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const teamId = parseInt(this.getAttribute('data-team-id'));
                    if (confirm('确定要删除这个战队吗？战队删除后，选手将变为自由选手。')) {
                        deleteTeam(teamId);
                    }
                });
            });
        }

        // 加载管理员选手列表
        function loadAdminPlayersList() {
            const list = document.getElementById('admin-players-list');
            list.innerHTML = '';
            
            appData.players.forEach(player => {
                const team = getTeamById(player.teamId);
                const teamName = team ? team.name : "自由选手";
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="checkbox-cell">
                        <input type="checkbox" class="player-checkbox" data-player-id="${player.id}">
                    </td>
                    <td>
                        <div class="d-flex align-center">
                            <img src="${player.img}" class="player-img-small" alt="${player.name}">
                            <div>
                                <div style="font-weight: 700;">${player.name}</div>
                                <div style="font-size: 0.85rem; color: #7f8c8d;">${player.realName || ''}</div>
                            </div>
                        </div>
                    </td>
                    <td>${teamName}</td>
                    <td><span class="rating-badge">${player.rating.toFixed(2)}</span></td>
                    <td>
                        <div class="d-flex" style="gap: 8px;">
                            <button class="btn btn-primary btn-sm edit-player-btn" data-player-id="${player.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger btn-sm delete-player-btn" data-player-id="${player.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                list.appendChild(row);
            });
            
            // 添加编辑选手事件
            document.querySelectorAll('.edit-player-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const playerId = parseInt(this.getAttribute('data-player-id'));
                    editPlayer(playerId);
                });
            });
            
            // 添加删除选手事件
            document.querySelectorAll('.delete-player-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const playerId = parseInt(this.getAttribute('data-player-id'));
                    if (confirm('确定要删除这个选手吗？')) {
                        deletePlayer(playerId);
                    }
                });
            });
        }

        // 加载管理员赛事列表
        function loadAdminMatchesList() {
            const list = document.getElementById('admin-matches-list');
            list.innerHTML = '';
            
            appData.matches.forEach(match => {
                const team1 = getTeamById(match.team1Id);
                const team2 = getTeamById(match.team2Id);
                const date = new Date(match.date);
                const formattedDate = date.toLocaleDateString('zh-CN');
                
                let scoreDisplay = 'VS';
                if (match.score1 !== null && match.score2 !== null) {
                    scoreDisplay = `${match.score1} : ${match.score2}`;
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="checkbox-cell">
                        <input type="checkbox" class="match-checkbox" data-match-id="${match.id}">
                    </td>
                    <td>
                        <div style="font-weight: 700;">${match.tournament}</div>
                        <div style="font-size: 0.85rem; color: #7f8c8d;">${match.type === 'today' ? '今日赛程' : match.type === 'past' ? '往期赛果' : '未来赛事'}</div>
                    </td>
                    <td>${team1?.name || '未知'} vs ${team2?.name || '未知'}</td>
                    <td>${scoreDisplay}</td>
                    <td>${formattedDate}</td>
                    <td>
                        <div class="d-flex" style="gap: 8px;">
                            <button class="btn btn-primary btn-sm edit-match-stats-btn" data-match-id="${match.id}">
                                <i class="fas fa-chart-bar"></i> 编辑数据
                            </button>
                            <button class="btn btn-danger btn-sm delete-match-btn" data-match-id="${match.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                list.appendChild(row);
            });
            
            // 添加编辑赛事数据事件
            document.querySelectorAll('.edit-match-stats-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const matchId = parseInt(this.getAttribute('data-match-id'));
                    editMatchStats(matchId);
                });
            });
            
            // 添加删除赛事事件
            document.querySelectorAll('.delete-match-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const matchId = parseInt(this.getAttribute('data-match-id'));
                    if (confirm('确定要删除这个赛事吗？')) {
                        deleteMatch(matchId);
                    }
                });
            });
        }

        // 编辑赛事详细数据
        function editMatchStats(matchId) {
            const match = getMatchById(matchId);
            if (!match) {
                alert('赛事不存在');
                return;
            }
            
            const team1 = getTeamById(match.team1Id);
            const team2 = getTeamById(match.team2Id);
            const team1Players = getTeamPlayers(match.team1Id);
            const team2Players = getTeamPlayers(match.team2Id);
            
            // 显示编辑表单
            const editForm = document.getElementById('match-edit-form');
            editForm.classList.add('active');
            
            // 设置表单标题
            document.querySelector('#match-edit-form .card-title').innerHTML = `
                <i class="fas fa-edit text-primary"></i>
                编辑赛事详情 - ${match.tournament}
            `;
            
            // 设置比分
            document.getElementById('match-stats-id').value = matchId;
            document.getElementById('edit-match-score1').value = match.score1 || 0;
            document.getElementById('edit-match-score2').value = match.score2 || 0;
            
            // 生成战队1选手数据表格
            const team1StatsBody = document.getElementById('team1-stats-body');
            team1StatsBody.innerHTML = '';
            
            team1Players.forEach(player => {
                const stats = match.stats.team1[player.id] || { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="d-flex align-center">
                            <img src="${player.img}" class="player-img-small" style="width: 30px; height: 30px;">
                            <div>
                                <div style="font-weight: 600;">${player.name}</div>
                                <div style="font-size: 0.75rem; color: #7f8c8d;">${team1?.name || ''}</div>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" class="form-control" value="${stats.kill}" data-player-id="${player.id}" data-stat="kill"></td>
                    <td><input type="number" class="form-control" value="${stats.death}" data-player-id="${player.id}" data-stat="death"></td>
                    <td><input type="number" class="form-control" value="${stats.swing}" data-player-id="${player.id}" data-stat="swing"></td>
                    <td><input type="number" step="0.1" class="form-control" value="${stats.adr}" data-player-id="${player.id}" data-stat="adr"></td>
                    <td><input type="number" class="form-control" value="${stats.kast}" data-player-id="${player.id}" data-stat="kast"></td>
                    <td><input type="number" step="0.01" class="form-control" value="${stats.rating}" data-player-id="${player.id}" data-stat="rating"></td>
                `;
                team1StatsBody.appendChild(row);
            });
            
            // 生成战队2选手数据表格
            const team2StatsBody = document.getElementById('team2-stats-body');
            team2StatsBody.innerHTML = '';
            
            team2Players.forEach(player => {
                const stats = match.stats.team2[player.id] || { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="d-flex align-center">
                            <img src="${player.img}" class="player-img-small" style="width: 30px; height: 30px;">
                            <div>
                                <div style="font-weight: 600;">${player.name}</div>
                                <div style="font-size: 0.75rem; color: #7f8c8d;">${team2?.name || ''}</div>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" class="form-control" value="${stats.kill}" data-player-id="${player.id}" data-stat="kill"></td>
                    <td><input type="number" class="form-control" value="${stats.death}" data-player-id="${player.id}" data-stat="death"></td>
                    <td><input type="number" class="form-control" value="${stats.swing}" data-player-id="${player.id}" data-stat="swing"></td>
                    <td><input type="number" step="0.1" class="form-control" value="${stats.adr}" data-player-id="${player.id}" data-stat="adr"></td>
                    <td><input type="number" class="form-control" value="${stats.kast}" data-player-id="${player.id}" data-stat="kast"></td>
                    <td><input type="number" step="0.01" class="form-control" value="${stats.rating}" data-player-id="${player.id}" data-stat="rating"></td>
                `;
                team2StatsBody.appendChild(row);
            });
            
            // 滚动到编辑表单
            editForm.scrollIntoView({ behavior: 'smooth' });
        }

        // 保存赛事详细数据
        function saveMatchStats(matchId) {
            const match = getMatchById(matchId);
            if (!match) return;
            
            // 更新比分
            match.score1 = parseInt(document.getElementById('edit-match-score1').value);
            match.score2 = parseInt(document.getElementById('edit-match-score2').value);
            
            // 更新战队1选手数据
            const team1Inputs = document.querySelectorAll('#team1-stats-body input');
            team1Inputs.forEach(input => {
                const playerId = parseInt(input.getAttribute('data-player-id'));
                const stat = input.getAttribute('data-stat');
                const value = input.type === 'number' ? parseFloat(input.value) : input.value;
                
                if (!match.stats.team1[playerId]) {
                    match.stats.team1[playerId] = { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 };
                }
                
                match.stats.team1[playerId][stat] = value;
            });
            
            // 更新战队2选手数据
            const team2Inputs = document.querySelectorAll('#team2-stats-body input');
            team2Inputs.forEach(input => {
                const playerId = parseInt(input.getAttribute('data-player-id'));
                const stat = input.getAttribute('data-stat');
                const value = input.type === 'number' ? parseFloat(input.value) : input.value;
                
                if (!match.stats.team2[playerId]) {
                    match.stats.team2[playerId] = { kill: 0, death: 0, swing: 0, adr: 0, kast: 0, rating: 0 };
                }
                
                match.stats.team2[playerId][stat] = value;
            });
            
            // 保存数据
            saveData();
            
            // 隐藏编辑表单
            document.getElementById('match-edit-form').classList.remove('active');
            
            // 重新加载赛事列表
            loadAdminMatchesList();
            
            alert('赛事数据已保存！');
        }

        // 编辑战队
        function editTeam(teamId) {
            const team = getTeamById(teamId);
            if (!team) return;
            
            document.getElementById('team-id').value = team.id;
            document.getElementById('team-name').value = team.name;
            document.getElementById('team-rank').value = team.rank;
            document.getElementById('team-points').value = team.points;
            document.getElementById('team-coach').value = team.coach || '';
            document.getElementById('team-achievements').value = Array.isArray(team.achievements) ? team.achievements.join(', ') : '';
            
            // 显示Logo预览
            const logoPreview = document.getElementById('team-logo-preview');
            logoPreview.innerHTML = team.logo ? `<img src="${team.logo}" style="max-width: 120px; border-radius: 8px; border: 2px solid #ddd;">` : '';
            
            // 滚动到表单
            document.getElementById('team-form').scrollIntoView({ behavior: 'smooth' });
        }

        // 删除战队
        function deleteTeam(teamId) {
            // 删除战队
            appData.teams = appData.teams.filter(t => t.id !== teamId);
            
            // 将原战队选手设为自由选手
            appData.players.forEach(player => {
                if (player.teamId === teamId) {
                    player.teamId = null;
                }
            });
            
            // 删除与该战队相关的比赛
            appData.matches = appData.matches.filter(m => m.team1Id !== teamId && m.team2Id !== teamId);
            
            // 保存数据并刷新
            saveData();
            loadAdminTeamsList();
            loadAdminPlayersList();
            loadAdminMatchesList();
            loadTeams();
            
            alert('战队已删除，原战队选手已设为自由选手。');
        }

        // 批量删除战队
        function batchDeleteTeams() {
            const checkboxes = document.querySelectorAll('.team-checkbox:checked');
            if (checkboxes.length === 0) {
                alert('请先选择要删除的战队');
                return;
            }
            
            if (!confirm(`确定要删除选中的 ${checkboxes.length} 个战队吗？战队删除后，选手将变为自由选手。`)) {
                return;
            }
            
            const teamIds = [];
            checkboxes.forEach(cb => {
                teamIds.push(parseInt(cb.getAttribute('data-team-id')));
            });
            
            // 批量删除
            teamIds.forEach(teamId => {
                // 删除战队
                appData.teams = appData.teams.filter(t => t.id !== teamId);
                
                // 将原战队选手设为自由选手
                appData.players.forEach(player => {
                    if (player.teamId === teamId) {
                        player.teamId = null;
                    }
                });
                
                // 删除与该战队相关的比赛
                appData.matches = appData.matches.filter(m => m.team1Id !== teamId && m.team2Id !== teamId);
            });
            
            // 保存数据并刷新
            saveData();
            loadAdminTeamsList();
            loadAdminPlayersList();
            loadAdminMatchesList();
            loadTeams();
            
            // 取消全选
            document.getElementById('select-all-teams').checked = false;
            
            alert(`成功删除 ${teamIds.length} 个战队`);
        }

        // 编辑选手
        function editPlayer(playerId) {
            const player = getPlayerById(playerId);
            if (!player) return;
            
            document.getElementById('player-id').value = player.id;
            document.getElementById('player-name').value = player.name;
            document.getElementById('player-realname').value = player.realName || '';
            document.getElementById('player-team').value = player.teamId || '';
            document.getElementById('player-age').value = player.age || '';
            document.getElementById('player-country').value = player.country || '';
            document.getElementById('player-rating-input').value = player.rating || 1.0;
            document.getElementById('player-achievements').value = Array.isArray(player.achievements) ? player.achievements.join(', ') : '';
            
            // 设置滑块值
            document.getElementById('player-firepower-input').value = player.stats.firepower;
            document.getElementById('player-entrying-input').value = player.stats.entrying;
            document.getElementById('player-trading-input').value = player.stats.trading;
            document.getElementById('player-opening-input').value = player.stats.opening;
            document.getElementById('player-clutching-input').value = player.stats.clutching;
            document.getElementById('player-utility-input').value = player.stats.utility || 50;
            
            // 更新滑块值显示
            document.getElementById('firepower-value').textContent = player.stats.firepower;
            document.getElementById('entrying-value').textContent = player.stats.entrying;
            document.getElementById('trading-value').textContent = player.stats.trading;
            document.getElementById('opening-value').textContent = player.stats.opening;
            document.getElementById('clutching-value').textContent = player.stats.clutching;
            document.getElementById('utility-value').textContent = player.stats.utility || 50;
            
            // 显示图片预览
            const imgPreview = document.getElementById('player-img-preview');
            imgPreview.innerHTML = player.img ? `<img src="${player.img}" style="max-width: 120px; border-radius: 8px; border: 2px solid #ddd;">` : '';
            
            // 滚动到表单
            document.getElementById('player-form').scrollIntoView({ behavior: 'smooth' });
        }

        // 删除选手
        function deletePlayer(playerId) {
            // 删除选手
            appData.players = appData.players.filter(p => p.id !== playerId);
            
            // 从战队中移除该选手
            appData.teams.forEach(team => {
                if (team.players) {
                    team.players = team.players.filter(pId => pId !== playerId);
                }
            });
            
            // 从比赛数据中移除该选手
            appData.matches.forEach(match => {
                if (match.stats) {
                    if (match.stats.team1 && match.stats.team1[playerId]) {
                        delete match.stats.team1[playerId];
                    }
                    if (match.stats.team2 && match.stats.team2[playerId]) {
                        delete match.stats.team2[playerId];
                    }
                }
            });
            
            // 保存数据并刷新
            saveData();
            loadAdminPlayersList();
            loadPlayers();
            
            alert('选手已删除。');
        }

        // 批量删除选手
        function batchDeletePlayers() {
            const checkboxes = document.querySelectorAll('.player-checkbox:checked');
            if (checkboxes.length === 0) {
                alert('请先选择要删除的选手');
                return;
            }
            
            if (!confirm(`确定要删除选中的 ${checkboxes.length} 个选手吗？`)) {
                return;
            }
            
            const playerIds = [];
            checkboxes.forEach(cb => {
                playerIds.push(parseInt(cb.getAttribute('data-player-id')));
            });
            
            // 批量删除
            playerIds.forEach(playerId => {
                // 删除选手
                appData.players = appData.players.filter(p => p.id !== playerId);
                
                // 从战队中移除该选手
                appData.teams.forEach(team => {
                    if (team.players) {
                        team.players = team.players.filter(pId => pId !== playerId);
                    }
                });
                
                // 从比赛数据中移除该选手
                appData.matches.forEach(match => {
                    if (match.stats) {
                        if (match.stats.team1 && match.stats.team1[playerId]) {
                            delete match.stats.team1[playerId];
                        }
                        if (match.stats.team2 && match.stats.team2[playerId]) {
                            delete match.stats.team2[playerId];
                        }
                    }
                });
            });
            
            // 保存数据并刷新
            saveData();
            loadAdminPlayersList();
            loadPlayers();
            
            // 取消全选
            document.getElementById('select-all-players').checked = false;
            
            alert(`成功删除 ${playerIds.length} 个选手`);
        }

        // 删除赛事
        function deleteMatch(matchId) {
            appData.matches = appData.matches.filter(m => m.id !== matchId);
            
            // 保存数据并刷新
            saveData();
            loadAdminMatchesList();
            loadMatches();
            
            alert('赛事已删除。');
        }

        // 批量删除赛事
        function batchDeleteMatches() {
            const checkboxes = document.querySelectorAll('.match-checkbox:checked');
            if (checkboxes.length === 0) {
                alert('请先选择要删除的赛事');
                return;
            }
            
            if (!confirm(`确定要删除选中的 ${checkboxes.length} 个赛事吗？`)) {
                return;
            }
            
            const matchIds = [];
            checkboxes.forEach(cb => {
                matchIds.push(parseInt(cb.getAttribute('data-match-id')));
            });
            
            // 批量删除
            appData.matches = appData.matches.filter(m => !matchIds.includes(m.id));
            
            // 保存数据并刷新
            saveData();
            loadAdminMatchesList();
            loadMatches();
            
            // 取消全选
            document.getElementById('select-all-matches').checked = false;
            
            alert(`成功删除 ${matchIds.length} 个赛事`);
        }

        // 初始化事件监听
        function initEventListeners() {
            // 导航栏点击事件
            document.querySelectorAll('.nav-link, .logo').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    if (pageId) {
                        switchPage(pageId);
                    }
                });
            });

            // 赛事标签页点击事件
            document.querySelectorAll('.tab-link').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // 移除所有active类
                    document.querySelectorAll('.tab-link').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
                    
                    // 激活当前标签
                    this.classList.add('active');
                    document.getElementById(tabId + '-matches').style.display = 'block';
                });
            });

            // 返回按钮事件
            document.getElementById('back-to-home').addEventListener('click', function() {
                switchPage('home');
            });
            
            document.getElementById('back-to-teams').addEventListener('click', function() {
                switchPage('teams');
            });
            
            document.getElementById('back-to-players').addEventListener('click', function() {
                document.getElementById('players-table').parentNode.parentNode.style.display = 'block';
                document.getElementById('player-detail').style.display = 'none';
            });

            // 管理员登录按钮
            document.getElementById('admin-login-btn').addEventListener('click', adminLogin);
            
            // 修改密码按钮
            document.getElementById('change-password-btn').addEventListener('click', changePassword);
            
            // 管理员退出按钮
            document.getElementById('admin-logout-btn').addEventListener('click', adminLogout);
            
            // 认证标签页切换
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-auth-tab');
                    
                    // 移除所有active类
                    document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.auth-content').forEach(c => c.classList.remove('active'));
                    
                    // 激活当前标签
                    this.classList.add('active');
                    document.getElementById(tabId + '-content').classList.add('active');
                });
            });

            // 批量删除按钮
            document.getElementById('batch-delete-teams').addEventListener('click', batchDeleteTeams);
            document.getElementById('batch-delete-players').addEventListener('click', batchDeletePlayers);
            document.getElementById('batch-delete-matches').addEventListener('click', batchDeleteMatches);

            // 战队表单提交
            document.getElementById('team-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const teamId = document.getElementById('team-id').value;
                const teamName = document.getElementById('team-name').value.trim();
                const teamRank = parseInt(document.getElementById('team-rank').value);
                const teamPoints = parseInt(document.getElementById('team-points').value);
                const teamCoach = document.getElementById('team-coach').value.trim();
                const achievements = document.getElementById('team-achievements').value
                    .split(',')
                    .map(a => a.trim())
                    .filter(a => a.length > 0);
                
                // 获取Logo
                const logoPreview = document.getElementById('team-logo-preview');
                let teamLogo = "https://via.placeholder.com/200/2ecc71/FFFFFF?text=" + teamName.substring(0, 3).toUpperCase();
                if (logoPreview.querySelector('img')) {
                    teamLogo = logoPreview.querySelector('img').src;
                }
                
                if (teamId) {
                    // 编辑现有战队
                    const index = appData.teams.findIndex(t => t.id === parseInt(teamId));
                    if (index !== -1) {
                        appData.teams[index].name = teamName;
                        appData.teams[index].rank = teamRank;
                        appData.teams[index].points = teamPoints;
                        appData.teams[index].coach = teamCoach;
                        appData.teams[index].logo = teamLogo;
                        appData.teams[index].achievements = achievements;
                    }
                } else {
                    // 添加新战队
                    const newId = appData.teams.length > 0 ? Math.max(...appData.teams.map(t => t.id)) + 1 : 1;
                    appData.teams.push({
                        id: newId,
                        name: teamName,
                        rank: teamRank,
                        points: teamPoints,
                        coach: teamCoach,
                        logo: teamLogo,
                        achievements: achievements,
                        players: []
                    });
                }
                
                // 保存数据并刷新
                saveData();
                loadAdminTeamsList();
                loadTeams();
                
                // 重置表单
                this.reset();
                document.getElementById('team-id').value = '';
                logoPreview.innerHTML = '';
                
                alert('战队已保存！');
            });

            // 重置战队表单
            document.getElementById('reset-team-form').addEventListener('click', function() {
                document.getElementById('team-form').reset();
                document.getElementById('team-id').value = '';
                document.getElementById('team-logo-preview').innerHTML = '';
            });

            // 选手表单提交
            document.getElementById('player-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const playerId = document.getElementById('player-id').value;
                const playerName = document.getElementById('player-name').value.trim();
                const playerRealName = document.getElementById('player-realname').value.trim();
                const playerTeamId = document.getElementById('player-team').value ? parseInt(document.getElementById('player-team').value) : null;
                const playerAge = document.getElementById('player-age').value ? parseInt(document.getElementById('player-age').value) : null;
                const playerCountry = document.getElementById('player-country').value.trim();
                const playerRating = document.getElementById('player-rating-input').value ? parseFloat(document.getElementById('player-rating-input').value) : 1.0;
                const playerAchievements = document.getElementById('player-achievements').value
                    .split(',')
                    .map(a => a.trim())
                    .filter(a => a.length > 0);
                
                // 获取选手数据
                const firepower = parseInt(document.getElementById('player-firepower-input').value);
                const entrying = parseInt(document.getElementById('player-entrying-input').value);
                const trading = parseInt(document.getElementById('player-trading-input').value);
                const opening = parseInt(document.getElementById('player-opening-input').value);
                const clutching = parseInt(document.getElementById('player-clutching-input').value);
                const utility = parseInt(document.getElementById('player-utility-input').value);
                
                // 获取图片
                const imgPreview = document.getElementById('player-img-preview');
                let playerImg = "https://via.placeholder.com/200/2ecc71/FFFFFF?text=" + (playerName.charAt(0) || 'P');
                if (imgPreview.querySelector('img')) {
                    playerImg = imgPreview.querySelector('img').src;
                }
                
                if (playerId) {
                    // 编辑现有选手
                    const index = appData.players.findIndex(p => p.id === parseInt(playerId));
                    if (index !== -1) {
                        const oldTeamId = appData.players[index].teamId;
                        
                        // 更新选手信息
                        appData.players[index].name = playerName;
                        appData.players[index].realName = playerRealName || playerName;
                        appData.players[index].teamId = playerTeamId;
                        appData.players[index].age = playerAge;
                        appData.players[index].country = playerCountry;
                        appData.players[index].rating = playerRating;
                        appData.players[index].img = playerImg;
                        appData.players[index].achievements = playerAchievements;
                        appData.players[index].stats = {
                            firepower,
                            entrying,
                            trading,
                            opening,
                            clutching,
                            utility
                        };
                        
                        // 如果更换了战队，更新战队成员列表
                        if (oldTeamId !== playerTeamId) {
                            // 从原战队移除
                            if (oldTeamId) {
                                const oldTeam = getTeamById(oldTeamId);
                                if (oldTeam && oldTeam.players) {
                                    oldTeam.players = oldTeam.players.filter(pId => pId !== parseInt(playerId));
                                }
                            }
                            
                            // 添加到新战队
                            if (playerTeamId) {
                                const newTeam = getTeamById(playerTeamId);
                                if (newTeam) {
                                    if (!newTeam.players) newTeam.players = [];
                                    if (!newTeam.players.includes(parseInt(playerId))) {
                                        newTeam.players.push(parseInt(playerId));
                                    }
                                }
                            }
                        }
                    }
                } else {
                    // 添加新选手
                    const newId = appData.players.length > 0 ? Math.max(...appData.players.map(p => p.id)) + 1 : 1;
                    const newPlayer = {
                        id: newId,
                        name: playerName,
                        realName: playerRealName || playerName,
                        teamId: playerTeamId,
                        age: playerAge,
                        country: playerCountry,
                        rating: playerRating,
                        img: playerImg,
                        achievements: playerAchievements,
                        stats: {
                            firepower,
                            entrying,
                            trading,
                            opening,
                            clutching,
                            utility
                        }
                    };
                    
                    appData.players.push(newPlayer);
                    
                    // 添加到战队成员列表
                    if (playerTeamId) {
                        const team = getTeamById(playerTeamId);
                        if (team) {
                            if (!team.players) team.players = [];
                            team.players.push(newId);
                        }
                    }
                }
                
                // 保存数据并刷新
                saveData();
                loadAdminPlayersList();
                loadPlayers();
                loadAdminTeamsList();
                loadTeams();
                
                // 重置表单
                this.reset();
                document.getElementById('player-id').value = '';
                imgPreview.innerHTML = '';
                document.getElementById('player-achievements').value = '';
                
                // 重置滑块值为默认值
                const defaultValues = { firepower: 50, entrying: 50, trading: 50, opening: 50, clutching: 50, utility: 50 };
                Object.keys(defaultValues).forEach(key => {
                    const slider = document.getElementById(`player-${key}-input`);
                    const valueSpan = document.getElementById(`${key}-value`);
                    if (slider && valueSpan) {
                        slider.value = defaultValues[key];
                        valueSpan.textContent = defaultValues[key];
                    }
                });
                
                document.getElementById('player-rating-input').value = 1.0;
                
                alert('选手已保存！');
            });

            // 重置选手表单
            document.getElementById('reset-player-form').addEventListener('click', function() {
                document.getElementById('player-form').reset();
                document.getElementById('player-id').value = '';
                document.getElementById('player-img-preview').innerHTML = '';
                document.getElementById('player-achievements').value = '';
                
                // 重置滑块值为默认值
                const defaultValues = { firepower: 50, entrying: 50, trading: 50, opening: 50, clutching: 50, utility: 50 };
                Object.keys(defaultValues).forEach(key => {
                    const slider = document.getElementById(`player-${key}-input`);
                    const valueSpan = document.getElementById(`${key}-value`);
                    if (slider && valueSpan) {
                        slider.value = defaultValues[key];
                        valueSpan.textContent = defaultValues[key];
                    }
                });
                
                document.getElementById('player-rating-input').value = 1.0;
            });

            // 赛事表单提交
            document.getElementById('match-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const matchId = document.getElementById('match-id').value;
                const tournament = document.getElementById('match-tournament').value.trim();
                const team1Id = parseInt(document.getElementById('match-team1').value);
                const team2Id = parseInt(document.getElementById('match-team2').value);
                const score1 = document.getElementById('match-score1').value ? parseInt(document.getElementById('match-score1').value) : null;
                const score2 = document.getElementById('match-score2').value ? parseInt(document.getElementById('match-score2').value) : null;
                const date = document.getElementById('match-date').value;
                const time = document.getElementById('match-time').value;
                const type = document.getElementById('match-type').value;
                
                if (matchId) {
                    // 编辑现有赛事
                    const index = appData.matches.findIndex(m => m.id === parseInt(matchId));
                    if (index !== -1) {
                        appData.matches[index].tournament = tournament;
                        appData.matches[index].team1Id = team1Id;
                        appData.matches[index].team2Id = team2Id;
                        appData.matches[index].score1 = score1;
                        appData.matches[index].score2 = score2;
                        appData.matches[index].date = date;
                        appData.matches[index].time = time;
                        appData.matches[index].type = type;
                    }
                } else {
                    // 添加新赛事
                    const newId = appData.matches.length > 0 ? Math.max(...appData.matches.map(m => m.id)) + 1 : 1;
                    
                    // 获取两队选手
                    const team1Players = getTeamPlayers(team1Id);
                    const team2Players = getTeamPlayers(team2Id);
                    
                    // 初始化比赛数据
                    const stats = {
                        team1: {},
                        team2: {}
                    };
                    
                    // 为每个选手初始化数据
                    team1Players.forEach(player => {
                        stats.team1[player.id] = {
                            kill: 0,
                            death: 0,
                            swing: 0,
                            adr: 0,
                            kast: 0,
                            rating: 0
                        };
                    });
                    
                    team2Players.forEach(player => {
                        stats.team2[player.id] = {
                            kill: 0,
                            death: 0,
                            swing: 0,
                            adr: 0,
                            kast: 0,
                            rating: 0
                        };
                    });
                    
                    appData.matches.push({
                        id: newId,
                        tournament,
                        team1Id,
                        team2Id,
                        score1,
                        score2,
                        date,
                        time,
                        type,
                        stats
                    });
                }
                
                // 保存数据并刷新
                saveData();
                loadAdminMatchesList();
                loadMatches();
                
                // 重置表单
                this.reset();
                document.getElementById('match-id').value = '';
                
                alert('赛事已保存！');
            });

            // 赛事详细数据表单提交
            document.getElementById('match-stats-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const matchId = parseInt(document.getElementById('match-stats-id').value);
                if (matchId) {
                    saveMatchStats(matchId);
                }
            });

            // 取消赛事编辑
            document.getElementById('cancel-match-edit').addEventListener('click', function() {
                document.getElementById('match-edit-form').classList.remove('active');
            });

            // 战队Logo上传
            document.getElementById('team-logo-upload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (!file.type.match('image.*')) {
                        alert('请选择图片文件');
                        return;
                    }
                    
                    if (file.size > 5 * 1024 * 1024) {
                        alert('图片大小不能超过5MB');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const img = document.createElement('img');
                        img.src = event.target.result;
                        img.style.maxWidth = '120px';
                        img.style.borderRadius = '8px';
                        img.style.border = '2px solid #ddd';
                        document.getElementById('team-logo-preview').innerHTML = '';
                        document.getElementById('team-logo-preview').appendChild(img);
                    };
                    reader.readAsDataURL(file);
                }
            });

            // 选手图片上传
            document.getElementById('player-img-upload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (!file.type.match('image.*')) {
                        alert('请选择图片文件');
                        return;
                    }
                    
                    if (file.size > 5 * 1024 * 1024) {
                        alert('图片大小不能超过5MB');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const img = document.createElement('img');
                        img.src = event.target.result;
                        img.style.maxWidth = '120px';
                        img.style.borderRadius = '8px';
                        img.style.border = '2px solid #ddd';
                        document.getElementById('player-img-preview').innerHTML = '';
                        document.getElementById('player-img-preview').appendChild(img);
                    };
                    reader.readAsDataURL(file);
                }
            });

            // 移动端菜单
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');
            
            function toggleMobileMenu() {
                hamburger.classList.toggle('active');
                navMenu.classList.toggle('active');
                
                if (navMenu.classList.contains('active')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = '';
                }
            }
            
            function closeMobileMenu() {
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
                document.body.style.overflow = '';
            }
            
            hamburger.addEventListener('click', toggleMobileMenu);
            
            // 点击菜单项关闭菜单
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', closeMobileMenu);
            });
            
            // 点击外部关闭菜单
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.nav-container') && navMenu.classList.contains('active')) {
                    closeMobileMenu();
                }
            });
            
            // 窗口调整大小时关闭菜单
            window.addEventListener('resize', function() {
                if (window.innerWidth > 992) {
                    closeMobileMenu();
                }
            });
        }

        // 初始化应用
        function initApp() {
            initData();
            initEventListeners();
            switchPage('home');
        }

        // 当页面加载完成时初始化应用
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
